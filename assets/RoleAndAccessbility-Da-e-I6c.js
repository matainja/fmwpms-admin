import{j as s,bk as E,b3 as y,r as m,b0 as G,b1 as B,a8 as I,B as J}from"./index-LS0xF6a6.js";import{d as k,f as d,h as S,R as K,r as C,j as Q}from"./staffForm-WJqJOo5I.js";import{H as W}from"./Header-CoBa_O2o.js";import{F as X,a as Y,b as A}from"./index.esm-BdK8EDN0.js";import{u as Z}from"./useDepartment-F5dLconr.js";const me="Add Staff",fe="Edit Staff",ue="Preview Staff details form Centralize System",pe="Back",$="Select Role",ee="Select role and access for user",se=!0,te="Save & Next",he="Personal Information",be="Basic information for an account opening",we="Save & Next",je="Others Information",xe="More information",Fe="Save to DB",{Tr:O,Th:P,Td:R,THead:ae,TBody:ie}=E,re=({readonly:f=!1,selectRole:h="",data:u,onValueChange:o})=>{const b=i=>{o==null||o("view",i)},w=i=>{o==null||o("edit",i)};return s.jsx("div",{children:s.jsxs(E,{children:[s.jsx(ae,{children:s.jsxs(O,{children:[s.jsx(P,{children:"Description"}),s.jsx(P,{children:"View Only"}),s.jsx(P,{children:"View & Edit Forms"})]})}),s.jsx(ie,{children:u==null?void 0:u.map((i,l)=>{var j;return((j=i.eligible)==null?void 0:j.some(x=>x.toLowerCase()===h.toLowerCase()))&&s.jsxs(O,{children:[s.jsx(R,{children:i.menu}),s.jsx(R,{children:s.jsx(y,{checked:i.view,onChange:()=>b(l),readOnly:f,disabled:i.edit})}),s.jsx(R,{children:s.jsx(y,{checked:i.edit,onChange:()=>w(l),readOnly:f})})]},l)})})]})})},ve=({type:f="add",staffId:h="",readonly:u=!1,headerTag:o="",buttonShow:b=se,buttonNameFirst:w=te,formValue:i=k,onFormSubmit:l,onFormSubmitLoading:j=!1})=>{const{getUnassignDepartmentForHr:x,getAllDepartmentForHr:L}=Z(),[N,U]=m.useState([]),[T,p]=m.useState([]),[H,_]=m.useState([]),F="Team",v="Department",g="User";m.useEffect(()=>{(async()=>{if(f==="add"){const e=await x();(e==null?void 0:e.status)==="success"&&_(e.data||[])}else{const e=await L(h);(e==null?void 0:e.status)==="success"&&_(e.data||[])}})()},[]),m.useEffect(()=>{const t=i.permission,e=[];e.push({menu:F,view:t.Team_view||!1,edit:t.Team_edit||!1,eligible:[d]}),e.push({menu:v,view:t.Department_view||!1,edit:t.Department_edit||!1,eligible:[d]}),e.push({menu:g,view:t.User_view||!1,edit:t.User_edit||!1,eligible:[S,d]}),p(e);const a=[];a.push({menu:F,view:!1,edit:!1,eligible:[d]}),a.push({menu:v,view:!1,edit:!1,eligible:[d]}),a.push({menu:g,view:!1,edit:!1,eligible:[S,d]}),U(a)},[i]);const M=(t,e)=>{t==="view"&&p(a=>{const r=[...a];return r[e]={...r[e],view:!r[e].view},r}),t==="edit"&&p(a=>{const r=[...a];return r[e]={...r[e],view:!0,edit:!r[e].edit},r})},z=t=>{const e={...t};e.permission=k.permission,T.forEach(a=>{a.menu===F?(e.permission.Team_view=a.view,e.permission.Team_edit=a.edit):a.menu===v?(e.permission.Department_view=a.view,e.permission.Department_edit=a.edit):a.menu===g&&(e.permission.User_view=a.view,e.permission.User_edit=a.edit)}),typeof l=="function"?l(e):console.error("onFormSubmit is not a function or is undefined")};return s.jsxs("div",{className:"w-full",children:[s.jsx(W,{title:$,subTitle:ee,titleTag:o}),s.jsx(X,{enableReinitialize:!0,initialValues:i,validationSchema:K,onSubmit:(t,{setSubmitting:e})=>{z(t),e(!1)},children:({values:t,errors:e,touched:a,isSubmitting:r})=>s.jsx(Y,{children:s.jsxs(G,{children:[s.jsx("div",{className:"md:grid grid-cols-2 gap-4",children:s.jsx(B,{label:"Role",invalid:!!(a.role&&e.role),children:s.jsx(A,{name:"role",children:({field:D,form:c})=>s.jsx(I,{field:D,form:c,options:C,value:C.filter(n=>n.value.toLowerCase()===t.role.toLowerCase()),onChange:n=>{c.setFieldValue("role",n==null?void 0:n.value),p(N),c.setFieldValue("department",[])}})})})}),t.role!==""&&t.role.toLowerCase()!==Q.toLowerCase()&&s.jsx("div",{children:s.jsx(re,{selectRole:t.role,data:T,onValueChange:M})}),t.role===S&&s.jsxs(B,{label:"Department select",children:[s.jsx(A,{name:"all_department",component:y,checked:t.all_department,className:"flex justify-end mb-4",children:"All Department"}),s.jsx(A,{name:"department",children:({field:D,form:c})=>s.jsx(I,{isMulti:!0,placeholder:"Please Select",field:D,form:c,options:H,value:H.filter(n=>t.department.includes(n.departmentId)),onChange:n=>{const V=n.map(q=>q.departmentId);c.setFieldValue("department",V)},isDisabled:t.all_department})})]}),s.jsx("div",{className:"flex justify-end gap-2",children:b&&s.jsx(J,{type:"submit",variant:"solid",loading:r,children:w})})]})})})]})};export{ve as R,he as a,pe as b,we as c,xe as d,je as e,Fe as f,ue as g,fe as h,me as i,be as s};
