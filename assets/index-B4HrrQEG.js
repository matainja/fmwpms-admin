import{r as l,j as e,b7 as W,bw as Y,Y as k,B as g,bx as q,by as Z,bl as p,ch as J,bu as K,a8 as Q,c as X,b as $,a7 as ee,u as b,T as se,aa as te,bo as _,A as ae,bB as V,ci as re,bn as S}from"./index-Dles2GGc.js";import{T as ne}from"./SvgIcon-kVAzcj_I.js";import{C as le}from"./Views-BeAgtkwm.js";import{H as v}from"./Header-BVrguNN-.js";import{u as N,o as ie,k as ce,i as oe,m as de}from"./useNavigation-SaAlQaOB.js";import{F as me}from"./ForDepartmentAndTeam-CcKbq3wR.js";import{u as L}from"./useAccessibility-CqToofrn.js";import{U as xe}from"./UsersAvatarGroup-0r-ERBzB.js";import{N as ue}from"./NotFound-D7lV1jev.js";import{G as D,a as he}from"./index-CLjdIays.js";import{c as y}from"./index-16kEkSuN.js";import fe from"./AddEditDepartment-Dlf-T4wn.js";import{u as M}from"./useDepartment-BvvrxLTr.js";import{d as ge,a as je}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as pe}from"./useThemeClass-Bv4J3TKz.js";import"./cloneDeep-DJN0yfLA.js";import"./useTeam-BIJXyePK.js";import"./lodash-CNjWL2g_.js";import"./acronym-CQkwuZDL.js";import"./DoubleSidedImage-RdXlNtjI.js";import"./index.esm-BNKjJ-ZT.js";const ve=({search:t,onChangeSearch:r})=>{const s=l.useRef(null),{Navigate:n}=N(),{canAccess:i}=L(),a=d=>{r(d.target.value)},c=()=>{n(ie)};return e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx(v,{title:"Departments",showYear:!0}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-1",children:[e.jsx(W,{ref:s,size:"sm",placeholder:"Search",prefix:e.jsx(Y,{className:"text-lg"}),value:t,onChange:a}),e.jsx(me,{}),i(k)&&e.jsx(g,{size:"sm",variant:"twoTone",icon:e.jsx(q,{}),onClick:c,children:"Add Department"})]})]})},Ne=({members:t})=>e.jsx(xe,{users:t}),be=({progression:t})=>{const[r,s]=l.useState(!1),n=l.useMemo(()=>t>70?{color:"green-500"}:t<40?{color:"red-500"}:{},[t]);return e.jsxs("div",{className:"relative w-full",children:[r&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:e.jsx(Z,{size:"sm",percent:t,...n})})]})},we=({data:t})=>{const{id:r,name:s,progression:n,description:i,member:a}=t,{Navigate:c}=N(),d=()=>{c(ce,r)};return e.jsx(p,{bodyClass:"h-full cursor-pointer",onClick:d,children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("div",{className:"flex justify-between w-40 md:w-80 lg:w-full truncate",children:e.jsx("h6",{children:s})}),e.jsx("p",{className:"mt-4 w-40 md:w-80 lg:w-full truncate",children:i}),e.jsxs("div",{className:"mt-3",children:[e.jsx(be,{progression:n===null?0:n}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(Ne,{members:a}),e.jsx("div",{className:"flex items-center rounded-full font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full",children:[e.jsx(J,{className:"text-base"}),e.jsx("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:a.length||0})]})})]})]})]})})},E=[{value:5,label:"5 / page"},{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:50,label:"50 / page"}],Te=({currentPage:t,itemsPerPage:r,onSetCurrentPage:s,onSetItemsPerPage:n,totalPage:i})=>{const a=({value:c})=>{n(c)};return e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(K,{displayTotal:!0,pageSize:r,total:i,currentPage:t,onChange:s}),e.jsx("div",{style:{minWidth:120},children:e.jsx(Q,{size:"sm",isSearchable:!1,defaultValue:E[0],options:E,onChange:c=>a(c)})})]})},Se=({loading:t=!1,departmentList:r})=>{const[s,n]=l.useState(1),[i,a]=l.useState(5),c=s*i,d=c-i,h=r.slice(d,c),f=o=>{n(o)},m=o=>{n(1),a(o)};return e.jsxs("div",{className:X("mt-6 h-full flex flex-col",t&&"justify-center"),children:[t&&e.jsx("div",{className:"flex justify-center",children:e.jsx($,{size:40})}),!t&&r.length===0&&e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{})}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:h.map(o=>e.jsx(we,{data:o},o==null?void 0:o.id))}),e.jsx(Te,{currentPage:s,onSetCurrentPage:f,itemsPerPage:i,onSetItemsPerPage:m,totalPage:r.length})]})},De=({isOpen:t=!1,onDialogClose:r,type:s=""})=>e.jsx(ee,{isOpen:t,bodyOpenClassName:"overflow-hidden",onClose:r,onRequestClose:r,children:e.jsx(fe,{actionType:s,onViewChange:r})}),ye=({id:t,title:r,time:s,description:n,progression:i,teamlist:a})=>{let c=new Date;const{Navigate:d}=N(),h=b(x=>x.year),[f,m]=l.useState(!1),[o,j]=l.useState(!1),[O,w]=l.useState(""),{canAccess:G}=L(),{removeDepartmentTeam:z}=M();l.useEffect(()=>{G(k)?m(!0):m(!1)},[]);const F=()=>{j(!1)},R=()=>{j(!0),w("editDepartment")},T=()=>{j(!0),w("editDepartmentTeam")},B=async()=>{const x={department_id:String(t),year:h.selectedYear,team_id:a.map(U=>Number(U.id))},u=await z(x);te((u==null?void 0:u.status)||je,(u==null?void 0:u.message)||ge)},H=x=>{d(oe,x)};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(p,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(v,{title:r,titleTag:"h5"}),e.jsx("div",{className:"md:flex justify-center items-center gap-2",children:f&&e.jsxs(e.Fragment,{children:[e.jsx(g,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(D,{}),onClick:R}),e.jsx(g,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(y,{})})]})})]}),e.jsx("div",{className:"mt-6 break-all",children:n})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("div",{className:"text-red-600",children:"Last Update: "}),e.jsx("div",{className:"text-black",children:s!==""?s:c.toLocaleDateString()})]})]})}),e.jsx(p,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(v,{title:"Associate with Team",titleTag:"h5"}),e.jsxs("div",{className:"md:flex justify-center items-center gap-2",children:[f&&a&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(g,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(D,{}),onClick:T}),e.jsx(g,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(y,{}),onClick:B})]}),f&&a&&a.length===0&&e.jsx(g,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(he,{}),onClick:T})]})]}),e.jsxs("div",{className:"mt-4 grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a&&a.length===0&&e.jsx("div",{children:"No team found..."}),a&&a.length>0&&a.map((x,u)=>e.jsx(se,{title:x.name,children:e.jsx("button",{type:"button",className:"text-white bg-green-700 hover:bg-green-800 focus:outline-none focus:ring-4 focus:ring-green-30 rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 w-full truncate font-semibold",onClick:()=>H(x.id),children:x.name},u)},u))]})]})})]}),e.jsx(De,{isOpen:o,type:O,onDialogClose:F})]})},{Tr:C,Th:P,Td:A,THead:Ee,TBody:Ce}=_,I=30,Pe=t=>(pe(),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ae,{size:28,shape:"circle",src:t.img}),t.name]})),Ae=({data:t})=>{const[r,s]=l.useState(!1),{Navigate:n}=N(),i=a=>{n(de,a)};return e.jsx("div",{children:e.jsxs(p,{className:"mt-4",children:[e.jsx(v,{title:"Associate with User",titleTag:"h5"}),e.jsx("div",{className:"mt-4",children:e.jsxs(_,{compact:!0,children:[e.jsx(Ee,{children:e.jsxs(C,{children:[e.jsx(P,{children:"User Name"}),e.jsx(P,{className:"flex justify-end me-3",children:"Action"})]})}),r?e.jsx(ne,{avatarInColumns:[0],columns:3,rows:5,avatarProps:{width:I,height:I}}):e.jsx(Ce,{children:t&&t.map((a,c)=>e.jsxs(C,{children:[e.jsx(A,{children:e.jsx(Pe,{id:a.staff_id||"-1",name:a.name||"",img:a.img||""})}),e.jsx(A,{className:"flex justify-end",children:e.jsx(g,{className:"mr-2 mb-2",variant:"solid",color:"green-600",size:"xs",onClick:()=>i(a.staff_id),children:"View"})})]},c))})]})})]})})},Ie=t=>{const{id:r}=V(),[s,n]=l.useState({}),i=b(re(String(r)));return l.useEffect(()=>{n(i||{})},[i]),e.jsxs("div",{children:[e.jsx(ye,{id:s.id||"",title:s.name||"",time:s.last_updated||"",description:s.description||"",progression:s.progression||0,teamlist:s.team||[]}),s.member&&s.member.length>0&&e.jsx(Ae,{data:s.member||[]})]})},ke=t=>e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex flex-auto items-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(S,{height:10}),e.jsx(S,{height:10,width:"60%"})]})})}),es=t=>{const{id:r}=V(),s=b(m=>m.department),[n,i]=l.useState(""),[a,c]=l.useState(!1),[d,h]=l.useState([]);M(),l.useEffect(()=>{},[]),l.useEffect(()=>{r==="all"&&h(s.slice().reverse())},[s,r]),l.useEffect(()=>{n===""&&h(s.slice().reverse())},[n]);const f=m=>{i(m);const o=d.filter(j=>j.name.toLowerCase().includes(m.toLowerCase()));h(o)};return a?e.jsx(ke,{}):e.jsx(e.Fragment,{children:r==="all"?e.jsxs(le,{className:"h-full",children:[e.jsx(ve,{search:n,onChangeSearch:f}),e.jsx(Se,{loading:a,departmentList:d||[]})]}):e.jsx(Ie,{})})};export{es as default};
