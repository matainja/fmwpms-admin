import{r as c,w as N,j as e,bg as j,a as O,B as R,as as T,at as L,h as M,bh as P,bi as D,u as w,aT as V}from"./index-DKWfWbdF.js";import{b as C,c as I,d as U,e as B,A as F,C as H}from"./SvgIcon-CzmPs33w.js";import"./Views-CfNBUDic.js";import{H as v}from"./Header-9KW_amg1.js";import{u as A,d as W,e as J,c as p,f as q,g as G}from"./useNavigation-_DlyiWsx.js";import{N as $}from"./react-number-format.es-BZv_BlkT.js";import{u as z}from"./useMail-DsDrBURn.js";import"./cloneDeep-DJN0yfLA.js";import"./useThemeClass-4cD7xx4k.js";const S=["line","bar","area"],E=s=>{const{series:t=[],width:r="100%",height:d=300,xAxis:a,customOptions:i,type:u="line",direction:m,donutTitle:g,donutText:n,className:f,..._}=s,h=c.useRef(null),y=c.useMemo(()=>{switch(u){case"line":return C;case"bar":return B;case"area":return U;case"donut":return I;default:return C}},[u]);let o=JSON.parse(JSON.stringify(y));const x=window.innerWidth<768,b=c.useCallback(()=>{if(h.current){const l=h.current.querySelectorAll("div.apexcharts-legend")[0];m===N&&(l.style.right="auto",l.style.left="0"),x&&(l.style.position="relative",l.style.top="0",l.style.justifyContent="start",l.style.padding="0")}},[m,x]);return c.useEffect(()=>{S.includes(u)&&b()},[u,b]),S.includes(u)&&(o.xaxis.categories=a),i&&(o={...o,...i}),u==="donut"&&(g&&(o.plotOptions.pie.donut.labels.total.label=g),n&&(o.plotOptions.pie.donut.labels.total.formatter=()=>n)),e.jsx("div",{ref:h,style:m===N?{direction:"ltr"}:{},className:"chartRef",children:e.jsx(F,{options:o,type:u,series:t,width:r,height:d,className:f,..._})})},K=({data:s={},className:t})=>{const r={legend:{show:!1}};return e.jsxs(j,{className:t,children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(v,{title:"Department-wise Distribution of Teams and Users",titleTag:"h5"})}),e.jsx(E,{series:s.series,xAxis:s.categories,height:"380px",customOptions:r})]})},Q=({data:s={labels:[],data:[]}})=>e.jsxs(j,{children:[e.jsx(v,{title:"Appraisel",titleTag:"h5"}),e.jsx("div",{className:"mt-6",children:s.data.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(E,{donutTitle:`${s.data.reduce((t,r)=>t+r,0)}`,donutText:" ",series:s.data,customOptions:{labels:s.labels},type:"donut"}),s.data.length===s.labels.length&&e.jsx("div",{className:"mt-6 grid grid-cols-2 gap-4 mx-auto",children:s.labels.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{badgeStyle:{backgroundColor:H[r]}}),e.jsx("span",{className:"font-semibold",children:t})]},t))})]})})]}),X=s=>{const t=document.createElement("div");return t.innerHTML=s,t.textContent||t.innerText||""},Y=({data:s=[],className:t})=>{const{Navigate:r}=A(),d=()=>{r(W)},a=i=>{r(J,i)};return e.jsxs(j,{className:t,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(v,{title:"Latest Messages",titleTag:"h5"}),e.jsx(R,{size:"sm",onClick:d,children:"View All"})]}),s.map(i=>e.jsx("div",{className:"flex items-center justify-between rounded-md mb-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-600/40 cursor-pointer user-select",onClick:()=>a(String(i.chat_id)),children:e.jsx("div",{className:"flex items-center gap-3 sm:justify-between w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"font-bold w-full truncate",children:i.chat_name}),e.jsx("div",{className:"w-full truncate",children:X(i.last_message)})]})})},i.chat_id))]})},k=({data:s={value:0,growShrink:0,onClick:p},label:t,valuePrefix:r,date:d})=>{const{Navigate:a}=A(),i=()=>{a(s.onClick)};return e.jsxs(j,{onClick:i,className:"cursor-pointer",children:[e.jsx("h6",{className:"font-semibold mb-4 text-sm",children:t}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("div",{children:e.jsx("h3",{className:"font-bold",children:e.jsx($,{thousandSeparator:!0,displayType:"text",value:s.value,prefix:r})})})})]})},Z=({data:s={}})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 lg:gap-4",children:[e.jsx(k,{data:s.register_user,label:"Register User",valuePrefix:"",date:"21 Jan 2025"}),e.jsx(k,{data:s.issued_transfer_order,label:"Issued transfer order",valuePrefix:"",date:"30 Jan 2025"})]}),ee=s=>e.jsx(e.Fragment,{});async function se(){try{return await T.fetchData({url:`${L}/api/admin/dashboard`,method:"get"})}catch(s){throw console.error("Error fetching Dashboard details:",s),s}}function te(){const s=M();return{getDashboard:async()=>{var r,d;try{const a=await se();if(a.status===200){const i=a.data;return s(P(i)),{status:"success",message:a.data.message}}return{status:"warning",message:a.data.message}}catch(a){return console.error("Error fetching Dashboard details:",a),{status:"danger",message:((d=(r=a==null?void 0:a.response)==null?void 0:r.data)==null?void 0:d.message)||a.toString()}}}}}const ae=s=>e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex flex-auto items-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(D,{height:10}),e.jsx(D,{height:10,width:"60%"})]})})}),re=s=>{const[t,r]=c.useState(!0),[d,a]=c.useState({register_user:{value:0,growShrink:0,onClick:p},kyc_requer:{value:0,growShrink:0,onClick:p},issued_transfer_order:{value:0,growShrink:0,onClick:p}}),[i,u]=c.useState({series:[{name:"",data:[]},{name:"",data:[]}],categories:[]}),[m,g]=c.useState({labels:["User Count","Evidence Done by User","Planning Contract Filled","Appraised by Supervisor","transfer User"],data:[]}),n=w(o=>o.dashboard),f=w(o=>o.mailList),{getDashboard:_}=te(),{getMail:h}=z();c.useEffect(()=>{(async()=>{await _(),f.length===0&&await h(),r(!1)})()},[]),c.useEffect(()=>{a({register_user:{value:n.user_count,growShrink:0,onClick:G},kyc_requer:{value:n.evidence_done_user,growShrink:0,onClick:p},issued_transfer_order:{value:n.transfer_user,growShrink:0,onClick:q}});const o=n.department_graph.map(l=>l.department_name),x=n.department_graph.map(l=>l.team_count),b=n.department_graph.map(l=>l.staff_count);u({series:[{name:"Team count",data:x},{name:"Staff count",data:b}],categories:o}),g({labels:["Free User","Evidence Done by User","Planning Contract Filled","Appraised by Supervisor","transfer User"],data:[n.unworked_user,n.evidence_done_user,n.planning_contracts_filled,n.appraised_by_supervisor,n.transfer_user]})},[n]);const y=f.slice(0,3);return t?e.jsx(ae,{}):(console.log(n),e.jsxs(V,{loading:t,children:[e.jsx(Z,{data:d}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(K,{data:i,className:"col-span-2"}),e.jsx(Q,{data:m})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(Y,{data:y,className:"lg:col-span-2"}),e.jsx(ee,{})]})]}))},ne=s=>e.jsx("div",{className:"lg:flex items-center justify-between mb-4 gap-3",children:e.jsx("div",{className:"mb-4 lg:mb-0",children:e.jsx(v,{title:"Executive Dashboard",subTitle:"Overview of key metrics"})})});function ge(){return e.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[e.jsx(ne,{}),e.jsx(re,{})]})}export{ge as default};
