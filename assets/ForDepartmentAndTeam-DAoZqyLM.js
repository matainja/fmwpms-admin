import{as as y,at as j,u as o,r as d,j as t,B as u,a7 as F,aa as C}from"./index-CDkEqm6-.js";import{b as w}from"./index-CDXKCqlP.js";import{H as A}from"./Header-qFXKe93H.js";import{d as E,a as S}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as P}from"./useDepartment-CvnFuVLg.js";import{u as Y}from"./useTeam-B_lz015c.js";async function L(r){return await y.fetchData({url:`${j}/api/admin/year_change_record?year=${r}`,method:"post"})}function N(){const r=o(s=>s.year.selectedYear);return{fetchPreviousData:async()=>{var s,n;try{return(await L(r)).status===201?{status:"success",message:"Fetch previous data get successfully"}:{status:"warning",message:"Error in fetching department data"}}catch(a){return console.error("Error fetching department list:",a),{status:"danger",message:((n=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:n.message)||a.toString()}}}}}const R=r=>{const c=o(e=>e.department),s=o(e=>e.team),n=o(e=>e.year.selectedYear),[a,i]=d.useState(!1),[p,m]=d.useState(!1),{fetchPreviousData:f}=N(),{getDepartment:h}=P(),{getTeam:g}=Y(),D=new Date().getFullYear(),l=()=>{i(!1)},x=()=>{i(!0)},v=async()=>{m(!0);const e=await f();(e==null?void 0:e.status)==="success"&&(await h(),await g(),i(!1)),C((e==null?void 0:e.status)||S,(e==null?void 0:e.message)||E),m(!1)};return t.jsxs(t.Fragment,{children:[n===D&&c.length===0&&s.length===0&&t.jsx(u,{size:"sm",variant:"solid",icon:t.jsx(w,{}),onClick:x,children:"Fetch Data"}),t.jsxs(F,{isOpen:a,bodyOpenClassName:"overflow-hidden",onClose:l,onRequestClose:l,children:[t.jsx(A,{title:"Confirmation box",titleTag:"h5"}),t.jsx("p",{children:"Are you sure to fetch previous year data"}),t.jsxs("div",{className:"text-center mt-6",children:[t.jsx(u,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:l,children:"Cancel"}),t.jsx(u,{variant:"solid",onClick:v,loading:p,children:"Fetch Data"})]})]})]})};export{R as F};
