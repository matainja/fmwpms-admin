import{j as e,bQ as F,B as o,cA as K,a$ as H,b0 as j,b1 as x,aa as w,bz as z,u as W,cD as B,r as M,bi as h,bg as u,cE as V,cw as X,cF as $,cG as G}from"./index-DMOw5CQP.js";import{b as I,f as L}from"./index-JTYDLIXC.js";import{u as P}from"./useMPMS-CMzeITNT.js";import{u as T,D as E}from"./useNavigation-iFuUiacm.js";import{H as _}from"./Header-D4yVbFtC.js";import{G as J}from"./index-BZ-jOCj1.js";import{S as f}from"./StaffInfoFeild-C0N_hb0x.js";import{F as Q,c as U,a as Y,b as g,e as v,j as y}from"./index.esm-DHrWPpXr.js";import{d as Z,a as ee}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as ie}from"./useAccessibility-CsxjHYGh.js";import"./index-BUCb47tP.js";import"./cloneDeep-DJN0yfLA.js";import"./lodash-BTk6KhxJ.js";const te=({title:b,subTitle:n,year:r,id:a})=>{const{Navigate:m}=T(),p=()=>{m(E,String(a),K,n)};return e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"mb-4 lg:mb-0 flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{title:b}),e.jsx("p",{children:n})]}),e.jsx(F,{className:"text-white bg-emerald-600 border-0 rounded",children:r})]}),e.jsxs("div",{className:"md:flex justify-center gap-2",children:[e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(J,{}),onClick:p}),e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(I,{})})]})]})},se=U().shape({obj_title:v().required("Title is required"),obj_weight:y().typeError("Weight must be a number").required("Weight is required"),Initiative:v().required("Initiative is required"),kpi:v().required("KPI is required"),target:y().typeError("Target must be a number").required("Target is required"),Responsible:v().required("Responsible is required")}),ae=({isOpen:b,onClose:n,objective:r,onSave:a})=>{const{EditAssociativeObjectiveMPMS:m}=P();if(!b||!r)return null;const p=async(i,{setSubmitting:c})=>{const N={id:Number(r.id),obj_title:i.obj_title,obj_weight:Number(i.obj_weight),Initiative:i.Initiative,kpi:i.kpi,target:Number(i.target),Responsible:i.Responsible},l=await m(N);w((l==null?void 0:l.status)||ee,(l==null?void 0:l.message)||Z),(l==null?void 0:l.status)==="success"&&(n(),a==null||a()),c(!1)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Edit Objective"}),e.jsx(Q,{initialValues:{...r},enableReinitialize:!0,validationSchema:se,onSubmit:p,children:({errors:i,touched:c})=>e.jsx(Y,{children:e.jsxs(H,{className:"space-y-4",children:[e.jsx(j,{label:"Objective Title",invalid:!!(i.obj_title&&c.obj_title),errorMessage:i.obj_title,children:e.jsx(g,{name:"obj_title",component:x,placeholder:"Enter objective title"})}),e.jsx(j,{label:"Objective Weight",invalid:!!(i.obj_weight&&c.obj_weight),errorMessage:i.obj_weight,children:e.jsx(g,{name:"obj_weight",component:x,placeholder:"Enter objective weight"})}),e.jsx(j,{label:"Initiative",invalid:!!(i.Initiative&&c.Initiative),errorMessage:i.Initiative,children:e.jsx(g,{name:"Initiative",component:x,placeholder:"Enter initiative"})}),e.jsx(j,{label:"KPI",invalid:!!(i.kpi&&c.kpi),errorMessage:i.kpi,children:e.jsx(g,{name:"kpi",component:x,placeholder:"Enter KPI"})}),e.jsx(j,{label:"Target",invalid:!!(i.target&&c.target),errorMessage:i.target,children:e.jsx(g,{name:"target",component:x,placeholder:"Enter target"})}),e.jsx(j,{label:"Responsible",invalid:!!(i.Responsible&&c.Responsible),errorMessage:i.Responsible,children:e.jsx(g,{name:"Responsible",component:x,placeholder:"Enter responsible person"})}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(o,{type:"button",variant:"solid",color:"gray-500",onClick:n,children:"Cancel"}),e.jsx(o,{type:"submit",variant:"solid",color:"green-600",children:"Save"})]})]})})})]})})},ue=b=>{const{type:n,id:r}=z(),a=W(B(n||"",r||"")),{Navigate:m}=T(),{canAccess:p}=ie(),{getMPMS:i,deleteDepartmentKraMPMS:c,deleteObjectKraMPMS:N}=P(),[l,S]=M.useState(!1),[k,D]=M.useState(null);M.useEffect(()=>{(async()=>{await i()})()},[]);const O=async()=>{m(E,r,$,n)},A=async()=>{m(E,r,G,n)},R=async t=>{const d={kra_id:String(r),department:String(t)},s=await c(d);w((s==null?void 0:s.status)||"warning",(s==null?void 0:s.message)||"Call developer")},C=t=>{const d=a[0].objs.find(s=>s.id===t);d&&(D(d),S(!0))},q=async t=>{const d={objectiveId:String(t)},s=await N(d);w((s==null?void 0:s.status)||"warning",(s==null?void 0:s.message)||"Call developer")};return a.length===0?e.jsxs("div",{className:"flex flex-col gap-4",style:{maxWidth:300},children:[e.jsxs("div",{className:"flex flex-auto items-center gap-2",children:[e.jsx("div",{children:e.jsx(h,{variant:"circle",height:35,width:35})}),e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(h,{height:10}),e.jsx(h,{height:10,width:"60%"})]})]}),e.jsx(h,{height:150})]}):e.jsxs("div",{children:[e.jsx(te,{title:a[0].kra_title,subTitle:n||"",year:a[0].year,id:a[0].id}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsx(_,{title:"Associate with Department",titleTag:"h5"}),e.jsx(o,{size:"xs",className:"mr-2",variant:"solid",color:"emerald-500",onClick:O,children:"Add Department"})]}),e.jsx("div",{className:"mt-4 grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a[0].departments.map(t=>e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-black",children:t.department_name}),e.jsx("div",{children:e.jsx(V,{className:"ml-1 rtl:mr-1 cursor-pointer",onClick:()=>R(t.department_id)})})]})},t.id))})]}),e.jsxs(u,{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsx(_,{title:"Associate with Objective",titleTag:"h5"}),e.jsx(o,{size:"xs",className:"mr-2",variant:"solid",color:"emerald-500",onClick:A,children:"Add Objective"})]}),e.jsx("div",{className:"grid gap-4 mt-4",children:a[0].objs.map((t,d)=>e.jsxs(u,{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-black",children:t.obj_title}),e.jsxs("div",{className:"md:flex justify-center gap-2",children:[e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(L,{}),onClick:()=>C(t.id)}),p(X)&&e.jsx(e.Fragment,{children:e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(I,{}),onClick:()=>q(t.id)})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(f,{title:"Weight:",value:String(t.obj_weight),customClassName:"flex gap-2"}),e.jsx(f,{title:"Initiative:",value:String(t.Initiative),customClassName:"flex gap-2"}),e.jsx(f,{title:"Kpi:",value:String(t.kpi),customClassName:"flex gap-2"}),e.jsx(f,{title:"Responsible:",value:t.Responsible,customClassName:"flex gap-2"})]})]},d))})]}),e.jsx(ae,{isOpen:l,onClose:()=>S(!1),objective:k})]})};export{ue as default};
