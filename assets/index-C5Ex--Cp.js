import{r as l,j as e,b7 as B,bx as W,Y as _,B as u,by as Y,bz as q,bm as p,ch as Z,bv as J,a8 as K,c as Q,b as X,a7 as $,u as N,T as ee,bp as L,A as se,bC as M,ci as te,bo as y}from"./index-DWXHjtMR.js";import{T as ae}from"./SvgIcon-DcsB-qw7.js";import{C as re}from"./Views-Ddp0BTdq.js";import{H as f}from"./Header-DKnPAL1Q.js";import{u as j,o as ne,k as O,i as le,m as ie}from"./useNavigation-DOFW-r4i.js";import{F as oe}from"./ForDepartmentAndTeam-B2eK9XOc.js";import{u as R}from"./useAccessibility-ZRLJubV-.js";import{U as ce}from"./UsersAvatarGroup-BZjqZ-Z-.js";import{N as de}from"./NotFound-S8mldMjM.js";import{G as C,a as me}from"./index-BbeePwIW.js";import{c as E}from"./index-58a7tIrd.js";import xe from"./AddEditDepartment-D6zrwddd.js";import{u as z,a as he}from"./useDepartment-BeY9iVXt.js";import{u as ue}from"./useThemeClass-BhfYO-ba.js";import"./cloneDeep-DJN0yfLA.js";import"./defaultErrorMessage.constant-Bll1G2ZT.js";import"./useTeam-BGASqtNX.js";import"./lodash-DavE7ptf.js";import"./acronym-CRzJ3K1s.js";import"./DoubleSidedImage-CT0JCnb4.js";import"./index.esm-DYYLkB7s.js";const ge=({search:t,onChangeSearch:r})=>{const s=l.useRef(null),{Navigate:n}=j(),{canAccess:i}=R(),a=m=>{r(m.target.value)},o=()=>{n(ne)};return e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx(f,{title:"Departments",showYear:!0}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-1",children:[e.jsx(B,{ref:s,size:"sm",placeholder:"Search",prefix:e.jsx(W,{className:"text-lg"}),value:t,onChange:a}),e.jsx(oe,{}),i(_)&&e.jsx(u,{size:"sm",variant:"twoTone",icon:e.jsx(Y,{}),onClick:o,children:"Add Department"})]})]})},pe=({members:t})=>e.jsx(ce,{users:t}),fe=({progression:t})=>{const[r,s]=l.useState(!1),n=l.useMemo(()=>t>70?{color:"green-500"}:t<40?{color:"red-500"}:{},[t]);return e.jsxs("div",{className:"relative w-full",children:[r&&e.jsxs("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 px-2 py-1 text-xs text-white bg-gray-800 rounded-lg shadow-lg whitespace-nowrap",role:"tooltip",children:["Overall Progress",e.jsx("div",{className:"absolute bottom-[-4px] left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-800 rotate-45"})]}),e.jsx("div",{onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:e.jsx(q,{size:"sm",percent:t,...n})})]})},je=({data:t})=>{const{id:r,name:s,progression:n,description:i,member:a}=t,{Navigate:o}=j(),m=()=>{o(O,r)};return e.jsx(p,{bodyClass:"h-full cursor-pointer",onClick:m,children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsx("div",{className:"flex justify-between w-40 md:w-80 lg:w-full truncate",children:e.jsx("h6",{children:s})}),e.jsx("p",{className:"mt-4 w-40 md:w-80 lg:w-full truncate",children:i}),e.jsxs("div",{className:"mt-3",children:[e.jsx(fe,{progression:n===null?0:n}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(pe,{members:a}),e.jsx("div",{className:"flex items-center rounded-full font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full",children:[e.jsx(Z,{className:"text-base"}),e.jsx("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:a.length||0})]})})]})]})]})})},P=[{value:5,label:"5 / page"},{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:50,label:"50 / page"}],ve=({currentPage:t,itemsPerPage:r,onSetCurrentPage:s,onSetItemsPerPage:n,totalPage:i})=>{const a=({value:o})=>{n(o)};return e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(J,{displayTotal:!0,pageSize:r,total:i,currentPage:t,onChange:s}),e.jsx("div",{style:{minWidth:120},children:e.jsx(K,{size:"sm",isSearchable:!1,defaultValue:P[0],options:P,onChange:o=>a(o)})})]})},Ne=({loading:t=!1,departmentList:r})=>{const[s,n]=l.useState(1),[i,a]=l.useState(5),o=s*i,m=o-i,x=r.slice(m,o),g=c=>{n(c)},h=c=>{n(1),a(c)};return e.jsxs("div",{className:Q("mt-6 h-full flex flex-col",t&&"justify-center"),children:[t&&e.jsx("div",{className:"flex justify-center",children:e.jsx(X,{size:40})}),!t&&r.length===0&&e.jsx("div",{className:"flex justify-center",children:e.jsx(de,{})}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:x.map(c=>e.jsx(je,{data:c},c==null?void 0:c.id))}),e.jsx(ve,{currentPage:s,onSetCurrentPage:g,itemsPerPage:i,onSetItemsPerPage:h,totalPage:r.length})]})},be=({isOpen:t=!1,onDialogClose:r,type:s=""})=>e.jsx($,{isOpen:t,bodyOpenClassName:"overflow-hidden",onClose:r,onRequestClose:r,children:e.jsx(xe,{actionType:s,onViewChange:r})}),we=({id:t,title:r,time:s,description:n,progression:i,teamlist:a})=>{let o=new Date;const{Navigate:m}=j();N(d=>d.year);const[x,g]=l.useState(!1),[h,c]=l.useState(!1),[v,b]=l.useState(""),[w,Pe]=l.useState(!1),{canAccess:G}=R();z(),l.useEffect(()=>{G(_)?g(!0):g(!1)},[]);const F=()=>{c(!1)},H=()=>{c(!0),b("editDepartment")},D=()=>{c(!0),b("editDepartmentTeam")},U=d=>{m(le,d)},T=async()=>{try{const d=await he({departmentId:String(t)});console.log("Deleted Department ID:",d.data.departmentId),console.log("Message:",d.data.message),m(O,"all")}catch(d){console.error("Delete failed:",d)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsxs(p,{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(f,{title:r,titleTag:"h5"}),e.jsx("div",{className:"md:flex justify-center items-center gap-2",children:x&&e.jsxs(e.Fragment,{children:[e.jsx(u,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(C,{}),onClick:H}),e.jsx(u,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(E,{}),onClick:T})]})})]}),e.jsx("div",{className:"mt-6 break-all",children:n})]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("div",{className:"text-red-600",children:"Last Update: "}),e.jsx("div",{className:"text-black",children:s!==""?s:o.toLocaleDateString()})]})]})}),e.jsx(p,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(f,{title:"Associate with Team",titleTag:"h5"}),e.jsxs("div",{className:"md:flex justify-center items-center gap-2",children:[x&&a&&a.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(C,{}),onClick:D}),e.jsx(u,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(E,{}),onClick:T,loading:w,disabled:w})]}),x&&a&&a.length===0&&e.jsx(u,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(me,{}),onClick:D})]})]}),e.jsxs("div",{className:`mt-4 grid md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto \r
                scrollbar-hide`,children:[a&&a.length===0&&e.jsx("div",{children:"No team found..."}),a&&a.length>0&&a.map((d,S)=>e.jsx(ee,{title:d.name,children:e.jsx("button",{type:"button",className:"text-white bg-green-700 hover:bg-green-800 focus:outline-none focus:ring-4 focus:ring-green-30 rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800 w-full truncate font-semibold",onClick:()=>U(d.id),children:d.name},S)},S))]})]})})]}),e.jsx(be,{isOpen:h,type:v,onDialogClose:F})]})},{Tr:A,Th:I,Td:k,THead:De,TBody:Te}=L,V=30,Se=t=>(ue(),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(se,{size:28,shape:"circle",src:t.img}),t.name]})),ye=({data:t})=>{const[r,s]=l.useState(!1),{Navigate:n}=j(),i=a=>{n(ie,a)};return e.jsx("div",{children:e.jsxs(p,{className:"mt-4",children:[e.jsx(f,{title:"Associate with User",titleTag:"h5"}),e.jsx("div",{className:"mt-4",children:e.jsxs(L,{compact:!0,children:[e.jsx(De,{children:e.jsxs(A,{children:[e.jsx(I,{children:"User Name"}),e.jsx(I,{className:"flex justify-end me-3",children:"Action"})]})}),r?e.jsx(ae,{avatarInColumns:[0],columns:3,rows:5,avatarProps:{width:V,height:V}}):e.jsx(Te,{children:t&&t.map((a,o)=>e.jsxs(A,{children:[e.jsx(k,{children:e.jsx(Se,{id:a.staff_id||"-1",name:a.name||"",img:a.img||""})}),e.jsx(k,{className:"flex justify-end",children:e.jsx(u,{className:"mr-2 mb-2",variant:"solid",color:"green-600",size:"xs",onClick:()=>i(a.staff_id),children:"View"})})]},o))})]})})]})})},Ce=t=>{const{id:r}=M(),[s,n]=l.useState({}),i=N(te(String(r)));return l.useEffect(()=>{n(i||{})},[i]),e.jsxs("div",{children:[e.jsx(we,{id:s.id||"",title:s.name||"",time:s.last_updated||"",description:s.description||"",progression:s.progression||0,teamlist:s.team||[]}),s.member&&s.member.length>0&&e.jsx(ye,{data:s.member||[]})]})},Ee=t=>e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex flex-auto items-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(y,{height:10}),e.jsx(y,{height:10,width:"60%"})]})})}),Qe=t=>{const{id:r}=M(),s=N(h=>h.department),[n,i]=l.useState(""),[a,o]=l.useState(!1),[m,x]=l.useState([]);z(),l.useEffect(()=>{},[]),l.useEffect(()=>{r==="all"&&x(s.slice().reverse())},[s,r]),l.useEffect(()=>{n===""&&x(s.slice().reverse())},[n]);const g=h=>{i(h);const c=m.filter(v=>v.name.toLowerCase().includes(h.toLowerCase()));x(c)};return a?e.jsx(Ee,{}):e.jsx(e.Fragment,{children:r==="all"?e.jsxs(re,{className:"h-full",children:[e.jsx(ge,{search:n,onChangeSearch:g}),e.jsx(Ne,{loading:a,departmentList:m||[]})]}):e.jsx(Ce,{})})};export{Qe as default};
