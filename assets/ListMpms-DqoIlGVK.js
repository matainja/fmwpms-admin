import{r as l,j as e,b7 as P,B as v,by as O,cC as z,cn as V,D as b,cD as T,ae as q,cE as B,bm as A,cz as G,T as I,cx as W,cF as $,cG as X,aa as C,cH as Y,aZ as Z,u as w,cI as J,a7 as Q,b5 as U,b6 as N}from"./index-CDkEqm6-.js";import{A as ee}from"./AdaptableCard-Hh6ZlhC8.js";import"./SvgIcon-CRsFv2gV.js";import{C as se}from"./Views-By-25HWl.js";import{H as E}from"./Header-qFXKe93H.js";import{T as te}from"./TextEllipsis-BCvPbSO3.js";import{u as k}from"./useMPMS-FU7pVTS3.js";import{d as L,a as R}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as ae,D as _,E as ie}from"./useNavigation-DKeU22nA.js";import{u as ne}from"./useAccessibility-BCdEocPM.js";import{F as re,c as le,a as oe,b as H,j as ce,e as de}from"./index.esm-Cs7TAVD3.js";import"./cloneDeep-DJN0yfLA.js";import"./useThemeClass-CT4Tk52f.js";import"./lodash-CqPUagu2.js";const me=({openDialog:s,onSearch:o})=>{const[g,j]=l.useState(""),m=u=>{const d=u.target.value;j(d),o&&o(d)};return e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsx(E,{title:"MPMS List",subTitle:"View complete mpms list",showYear:!0}),e.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[e.jsx(P,{size:"sm",type:"text",value:g,onChange:m,placeholder:"Search MPMS...",className:"border rounded-xl px-2 py-2 text-sm w-full md:w-64 focus:outline-none "}),e.jsx("div",{children:e.jsx(v,{size:"sm",variant:"solid",icon:e.jsx(O,{}),onClick:()=>s("add"),children:"Create MPMS Head"})})]})]})},ue=({data:s,openDialog:o})=>{var D;const[g,j]=l.useState(!1),[m,u]=l.useState(""),[d,x]=l.useState(!1),{Navigate:n}=ae(),{canAccess:p}=ne(),{deleteMPMS:M,deleteKraMPMS:S}=k(),c=()=>{x(!d)},h=(i,a)=>{n(ie,String(a),i)},r=(i,a)=>{n(_,String(i),X,a)},t=async i=>{const a=await M(String(i));C((a==null?void 0:a.status)||R,(a==null?void 0:a.message)||L)},F=(i,a,f)=>{i.stopPropagation(),n(_,String(f),Y,a)},K=async(i,a)=>{i.stopPropagation();const f=await S(String(a));C((f==null?void 0:f.status)||R,(f==null?void 0:f.message)||L)},y=l.useMemo(()=>m.trim()?s==null?void 0:s.MPMS.kras.filter(i=>{var a;return(a=i.kra_title)==null?void 0:a.toLowerCase().includes(m.toLowerCase())}):(s==null?void 0:s.MPMS.kras)||[],[m,s==null?void 0:s.MPMS.kras]);return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer select-none w-80",onClick:c,children:[e.jsx("span",{className:"text-lg",children:d?e.jsx(z,{}):e.jsx(V,{})}),e.jsx("h5",{children:s.label}),e.jsxs("span",{children:["(",(D=s==null?void 0:s.MPMS)==null?void 0:D.kras.length,")"]})]}),e.jsx("hr",{className:"mx-3 w-full"}),e.jsxs(b,{placement:"bottom-end",renderTitle:e.jsx(v,{shape:"circle",variant:"plain",icon:e.jsx(q,{})}),children:[e.jsx(b.Item,{eventKey:"addArticle",onClick:()=>r(s.MPMS.id,s.value),children:"Add KRAs"}),e.jsx(b.Item,{eventKey:"rename",onClick:()=>o("rename",s.MPMS.id),children:"Rename"}),p(T)&&e.jsxs(e.Fragment,{children:[" ",e.jsx(b.Item,{eventKey:"delete",onClick:()=>t(s.MPMS.id),children:"Delete"})]})]})]}),e.jsxs(B.div,{className:"grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4 mt-4",initial:{opacity:0,height:0,overflow:"hidden"},animate:{opacity:d?0:1,height:d?0:"auto"},transition:{duration:.15},children:[(s==null?void 0:s.MPMS.kras.length)===0&&e.jsx(A,{clickable:!0,className:"group border-dashed border-2 hover:border-indigo-600",onClick:()=>r(s.MPMS.id,s.value),children:e.jsxs("div",{className:"flex flex-col justify-center items-center py-5",children:[e.jsx("div",{className:"p-4 border-2 border-dashed rounded-full border-gray-200 dark:border-gray-600 group-hover:border-indigo-600",children:e.jsx(G,{className:"text-4xl text-gray-200 dark:text-gray-600 group-hover:text-indigo-600"})}),e.jsx("p",{className:"mt-5 font-semibold",children:"Add KRAs"})]})}),e.jsx("div",{className:"col-span-full flex justify-start mb-2 mt-2 ms-2",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(P,{size:"sm",type:"text",value:m,onChange:i=>u(i.target.value),placeholder:"Search KRAs..."})})}),y==null?void 0:y.map(i=>e.jsxs(A,{bordered:!0,onClick:()=>h(s.value,i.id),className:"cursor-pointer overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"w-full truncate",children:e.jsx("h5",{children:i.kra_title})}),e.jsxs("div",{className:"flex",children:[p(T)&&e.jsx(e.Fragment,{children:e.jsx(I,{title:"Delete",children:e.jsx(v,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx(W,{}),onClick:a=>K(a,i.id)})})}),e.jsx(I,{title:"Edit",children:e.jsx(v,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx($,{}),onClick:a=>F(a,s.value,i.id)})})]})]}),e.jsx(te,{text:i.kra_title.replace(/<[^>]*>?/gm,""),maxTextCount:120})]},i.id))]})]})},he=({openDialog:s,data:o})=>{const[g,j]=l.useState(!1),[m,u]=l.useState(""),d=l.useMemo(()=>{if(!m.trim())return o;const x=m.toLowerCase();return o.filter(n=>((n==null?void 0:n.label)||"").toLowerCase().includes(x))},[m,o]);return console.log("filteredData",d),e.jsxs(e.Fragment,{children:[e.jsx(me,{openDialog:s,onSearch:u}),e.jsx(Z,{loading:g,children:d.length>0?d.map((x,n)=>e.jsx(ue,{data:x,openDialog:s},n)):e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"No data available"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"There's no information to display at the moment"}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-800 transition-colors",children:"Refresh Data"})]})})]})},xe=le().shape({name:de().required("Name Required"),point:ce().required("Point Required")}),ge=({type:s,open:o,onDialogClose:g,contentId:j})=>{const m=w(c=>c.mpms),u=w(J(j||"")),[d,x]=l.useState({id:"",name:"",point:0}),n=l.useRef(!0),{getMPMS:p,addMPMS:M,editMPMS:S}=k();return l.useEffect(()=>{const c=async()=>{await p()};m.length===0&&c()},[]),l.useEffect(()=>{s==="rename"&&u.length>0&&n.current&&(x({id:String(u[0].id)||"",name:u[0].heading||"",point:u[0].point||0}),n.current=!1),s==="add"&&n.current&&(x({id:"",name:"",point:0}),n.current=!1),!o&&!n.current&&(x({id:"",name:"",point:0}),n.current=!0)},[o,s,u]),e.jsxs(Q,{isOpen:o,bodyOpenClassName:"overflow-hidden",onClose:g,onRequestClose:g,children:[s==="add"&&e.jsx("div",{className:"mb-5",children:e.jsx(E,{title:"Add MPMS Category",titleTag:"h5"})}),s==="rename"&&e.jsx("div",{className:"mb-5",children:e.jsx(E,{title:"Rename MPMS Category",titleTag:"h5"})}),e.jsx(re,{enableReinitialize:!0,initialValues:d,validationSchema:xe,onSubmit:async(c,{setSubmitting:h})=>{if(s==="rename"){const r={id:c.id,heading:c.name,point:c.point},t=await S(r);(t==null?void 0:t.status)==="success"&&g(),C((t==null?void 0:t.status)||"warning",(t==null?void 0:t.message)||"Call developer")}else{const r={heading:c.name,point:c.point},t=await M(r);(t==null?void 0:t.status)==="success"&&g(),C((t==null?void 0:t.status)||"warning",(t==null?void 0:t.message)||"Call developer")}setTimeout(()=>{h(!1)},400)},children:({touched:c,isSubmitting:h,errors:r})=>e.jsx(oe,{children:e.jsxs(U,{children:[e.jsx(N,{label:"Heading",invalid:r.name&&c.name,errorMessage:r.name,children:e.jsx(H,{type:"text",autoComplete:"off",name:"name",placeholder:"Name",component:P})}),e.jsx(N,{label:"Point",invalid:r.name&&c.name,errorMessage:r.name,children:e.jsx(H,{type:"number",autoComplete:"off",name:"point",placeholder:"Point",onWheel:t=>t.target.blur(),component:P})}),e.jsx(N,{children:e.jsx(v,{variant:"solid",type:"submit",loading:h,children:"Submit"})})]})})})]})},De=s=>{const o=w(h=>h.mpms),[g,j]=l.useState([]),[m,u]=l.useState(!1),[d,x]=l.useState(""),[n,p]=l.useState(""),{getMPMS:M}=k();l.useEffect(()=>{const h=async()=>{await M()};o.length===0&&h()},[]),l.useEffect(()=>{const h=o.map(r=>({value:r.heading,label:r.heading,MPMS:r}));j(h)},[o]);const S=(h,r)=>{x(h),u(!0),p(r?String(r):"")},c=()=>{x(""),u(!1)};return e.jsx(se,{children:e.jsxs(ee,{children:[e.jsx(ge,{type:d,open:m,onDialogClose:c,contentId:n}),e.jsx(he,{openDialog:S,data:g})]})})};export{De as default};
