import{j as e,ao as ss,cj as ts,ck as as,bm as ce,aZ as Me,A as B,af as J,r as f,cl as is,a4 as de,cm as Ne,cn as Ce,b5 as se,b6 as R,b7 as W,B as I,co as _e,cp as Ee,aa as _,cq as ls,_ as ns,$ as Oe,cr as Re,T as pe,ax as rs,bp as Te,bv as os,a8 as me,bx as cs,cs as ds,a as Le,ct as ms,be as we,u as P,h as Y,cu as fs,by as Fe,a7 as Q,cv as us,cw as be,cx as hs,c as He,cy as te,bF as xs,bG as gs,bH as ps,bI as js,bJ as vs,bK as ws,bL as bs,bM as Ss,cz as Is,bC as ze,bo as Pe}from"./index-Pw4mwrwo.js";import{G as ys,u as Ns,f as Ue,g as Cs,h as _s,i as Es,R as Fs}from"./SvgIcon-8elp82MC.js";import{C as Ps}from"./Views-CPstB1zi.js";import{N as Us}from"./react-number-format.es-C1Gb1b5Y.js";import{M as Ds}from"./MediaSkeleton-X8430gxV.js";import{A as qe}from"./AdaptableCard-BHEwaQaf.js";import{d as U,a as D}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as Se,q as Ge,m as ks,r as Vs,s as As,t as Bs,v as Ms,w as Os,x as Rs,y as Ts,z as Ls,A as Hs}from"./useNavigation-B19iVSJA.js";import{u as $e}from"./useAccessibility-C8tr_FWU.js";import{u as A}from"./useStaff-surt25xH.js";import{N as zs}from"./NotFound-C03SR5cG.js";import{F as ae,c as fe,a as ie,b as T,e as K,f as Ie}from"./index.esm-C0qOZ4b9.js";import{d as qs,e as Gs}from"./index-BRLbsEUR.js";import{U as $s,P as ye,a as Ws,b as Xs,c as Ks,d as We,D as Zs,e as ue,f as Js,g as Ys,h as Qs,i as ee,j as De,k as et,l as st,m as je,n as tt,o as at,p as it,q as lt,r as nt,s as rt,t as ot,u as ct,v as dt,w as mt,x as ft,y as ut,z as ht,A as xt,B as gt,C as pt,E as jt,F as vt,G as wt,H as bt,I as St,J as It,K as yt,L as Nt,M as ve,N as Ct,O as _t,Q as Et,R as Ft}from"./AccessInformation-BKcXDHtm.js";import{H as oe}from"./Header-BOQvIOcD.js";import{D as Pt}from"./DoubleSidedImage-DIt7gOVn.js";import{l as Z}from"./lodash-B2wImiZp.js";import{S as k}from"./StaffInfoFeild-B1xOjEBm.js";import{b as ke,c as Ut,d as Dt}from"./index-BaincH2h.js";import{i as Xe}from"./isLastChild-BgvHfb_g.js";import{F as X}from"./FormImageChoose-DEO6apXY.js";import{R as kt}from"./RoleAndAccessbility-BgoPcsk7.js";import{E as Vt,i as Ke}from"./staffForm-C3evRh4D.js";import"./cloneDeep-DJN0yfLA.js";import"./useThemeClass-Cza5bR3P.js";import"./index-Cek5vuXv.js";import"./useDepartment-BCXSRJ5U.js";const ge=s=>{const{icon:i,avatarClass:t,label:a,value:m,growthRate:n,loading:r,onClickedFunction:d}=s,h=55;return e.jsx(ce,{bordered:!0,onClick:()=>d==null?void 0:d(a||""),className:`${d?"cursor-pointer":"cursor-default"}`,children:e.jsx(Me,{loading:r,customLoader:e.jsx(Ds,{avatarProps:{className:"rounded",width:h,height:h}}),children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{className:t,size:h,icon:i}),e.jsxs("div",{children:[e.jsx("span",{children:a}),e.jsx("h3",{children:e.jsx(Us,{thousandSeparator:!0,displayType:"text",value:m})})]})]}),e.jsx(ys,{value:n,suffix:"%"})]})})})},At=({total:s,active:i,blocked:t,onClickedFunction:a})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mb-6",children:[e.jsx(ge,{icon:e.jsx(ss,{}),avatarClass:"!bg-indigo-600",label:s.label,value:s.value,growthRate:s.growShrink,loading:!1,onClickedFunction:a}),e.jsx(ge,{icon:e.jsx(ts,{}),avatarClass:"!bg-indigo-600",label:i.label,value:i.value,growthRate:i.growShrink,loading:!1,onClickedFunction:a}),e.jsx(ge,{icon:e.jsx(as,{}),avatarClass:"!bg-emerald-500",label:t.label,value:t.value,growthRate:t.growShrink,loading:!1,onClickedFunction:a})]});function Bt(s){return J({attr:{viewBox:"0 0 24 24",fill:"currentColor"},child:[{tag:"path",attr:{d:"M18 8H20C20.5523 8 21 8.44772 21 9V21C21 21.5523 20.5523 22 20 22H4C3.44772 22 3 21.5523 3 21V9C3 8.44772 3.44772 8 4 8H6V7C6 3.68629 8.68629 1 12 1C15.3137 1 18 3.68629 18 7V8ZM5 10V20H19V10H5ZM11 14H13V16H11V14ZM7 14H9V16H7V14ZM15 14H17V16H15V14ZM16 8V7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7V8H16Z"},child:[]}]})(s)}function Mt(s){return J({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 17v4"},child:[]},{tag:"path",attr:{d:"M10 20l4 -2"},child:[]},{tag:"path",attr:{d:"M10 18l4 2"},child:[]},{tag:"path",attr:{d:"M5 17v4"},child:[]},{tag:"path",attr:{d:"M3 20l4 -2"},child:[]},{tag:"path",attr:{d:"M3 18l4 2"},child:[]},{tag:"path",attr:{d:"M19 17v4"},child:[]},{tag:"path",attr:{d:"M17 20l4 -2"},child:[]},{tag:"path",attr:{d:"M17 18l4 2"},child:[]},{tag:"path",attr:{d:"M9 6a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"},child:[]},{tag:"path",attr:{d:"M7 14a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2"},child:[]}]})(s)}const Ot=fe().shape({password:K().required("New Password is required").min(6,"Password must be at least 6 characters"),password_confirmation:K().required("Confirm Password is required").oneOf([Ie("password")],"Passwords must match")}),Rt=fe().shape({email:K().required("Email is required").email("Enter a valid email address"),confirm_email:K().required("Confirm Email is required").oneOf([Ie("email")],"Emails must match")}),Tt=({visible:s,onClose:i,staffId:t})=>{const[a,m]=f.useState(!1),[n,r]=f.useState(!1),[d,h]=f.useState("email"),b=is(),{updateStaffPasword:l,updateStaffEmailId:o}=A(),c=async(v,{setSubmitting:u,resetForm:g})=>{const w={staff_id:t,password:v.password},S=await l(w);_((S==null?void 0:S.status)||D,(S==null?void 0:S.message)||U),(S==null?void 0:S.status)==="success"&&(g(),i()),u(!1)},p=async(v,{setSubmitting:u,resetForm:g})=>{const w={staff_id:t,email:v.email},S=await o(w);_((S==null?void 0:S.status)||D,(S==null?void 0:S.message)||U),(S==null?void 0:S.status)==="success"&&(g(),i(),b(ls(w))),u(!1)};return e.jsx(de,{title:"Reset Credentials",isOpen:s,placement:"right",width:420,onClose:i,children:e.jsxs("div",{className:"space-y-6 px-2 py-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-l-4 border-gray-400 text-gray-700 text-sm rounded-md",children:[e.jsx("strong",{children:"Info:"})," You are resetting credentials for Staff ID: ",e.jsx("strong",{children:t}),"."]}),e.jsxs("div",{className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 hover:bg-gray-200 px-4 py-3 cursor-pointer transition-all duration-200 border-b border-gray-200",onClick:()=>h(d==="email"?null:"email"),children:[e.jsx("h4",{className:"font-semibold text-gray-800 text-base tracking-wide",children:"Email Reset"}),d==="email"?e.jsx(Ne,{className:"text-gray-600"}):e.jsx(Ce,{className:"text-gray-600"})]}),d==="email"&&e.jsx("div",{className:"p-5 bg-white border-t border-gray-200 rounded-b-xl shadow-inner animate-fadeIn",children:e.jsx(ae,{initialValues:{email:"",confirm_email:""},validationSchema:Rt,onSubmit:p,children:({errors:v,touched:u,isSubmitting:g})=>e.jsx(ie,{children:e.jsxs(se,{className:"space-y-4",children:[e.jsx(R,{label:"* New Email",invalid:!!(v.email&&u.email),errorMessage:v.email,children:e.jsx(T,{name:"email",type:"email",placeholder:"Enter new email address",component:W})}),e.jsx(R,{label:"* Confirm Email",invalid:!!(v.confirm_email&&u.confirm_email),errorMessage:v.confirm_email,children:e.jsx(T,{name:"confirm_email",type:"email",placeholder:"Re-enter email address",component:W})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(I,{variant:"solid",type:"submit",loading:g,children:"Submit"}),e.jsx(I,{variant:"twoTone",onClick:i,children:"Cancel"})]})]})})})})]}),e.jsxs("div",{className:"border border-gray-200 rounded-xl shadow-sm overflow-hidden bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 hover:bg-gray-200 px-4 py-3 cursor-pointer transition-all duration-200 border-b border-gray-200",onClick:()=>h(d==="password"?null:"password"),children:[e.jsx("h4",{className:"font-semibold text-gray-800 text-base tracking-wide",children:"Password Reset"}),d==="password"?e.jsx(Ne,{className:"text-gray-600"}):e.jsx(Ce,{className:"text-gray-600"})]}),d==="password"&&e.jsx("div",{className:"p-5 bg-white border-t border-gray-200 rounded-b-xl shadow-inner animate-fadeIn",children:e.jsx(ae,{initialValues:{password:"",password_confirmation:""},validationSchema:Ot,onSubmit:c,children:({errors:v,touched:u,isSubmitting:g})=>e.jsx(ie,{children:e.jsxs(se,{className:"space-y-4",children:[e.jsx(R,{label:"* New Password",invalid:!!(v.password&&u.password),errorMessage:v.password,children:e.jsx(T,{name:"password",type:a?"text":"password",placeholder:"Enter new password",component:W,suffix:e.jsx("span",{className:"cursor-pointer",onClick:()=>m(w=>!w),children:a?e.jsx(_e,{}):e.jsx(Ee,{})})})}),e.jsx(R,{label:"* Confirm Password",invalid:!!(v.password_confirmation&&u.password_confirmation),errorMessage:v.password_confirmation,children:e.jsx(T,{name:"password_confirmation",type:n?"text":"password",placeholder:"Re-enter password",component:W,suffix:e.jsx("span",{className:"cursor-pointer",onClick:()=>r(w=>!w),children:n?e.jsx(_e,{}):e.jsx(Ee,{})})})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(I,{variant:"solid",type:"submit",loading:g,children:"Submit"}),e.jsx(I,{variant:"twoTone",onClick:i,children:"Cancel"})]})]})})})})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 text-sm rounded-md",children:[e.jsx("strong",{children:"Note:"})," Changing the email or password will require the staff member to use the new credentials for future logins."]})]})})},Lt=fe().shape({ippis_no:K().required("IPPIS No. is required").matches(/^\d+$/,"IPPIS No. must be numeric").min(4,"IPPIS No. must be at least 4 digits"),confirm_ippis_no:K().oneOf([Ie("ippis_no"),null],"IPPIS No. does not match").required("Please confirm IPPIS No.")}),Ht=({visible:s,onClose:i,staffId:t,onSuccess:a})=>{const{updateStaffIppisNo:m}=A(),n=async(r,{setSubmitting:d,resetForm:h})=>{const b={staff_id:t,ippis_no:r.ippis_no},l=await m(b);_((l==null?void 0:l.status)||D,(l==null?void 0:l.message)||U),(l==null?void 0:l.status)==="success"&&(h(),i(),a==null||a(r.ippis_no)),d(!1)};return e.jsx(de,{title:"Reset IPPIS No.",isOpen:s,onClose:i,placement:"right",width:400,children:e.jsxs("div",{className:"space-y-6 px-2 py-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Reset IPPIS No. for ",e.jsx("strong",{children:t})]}),e.jsx(ae,{initialValues:{ippis_no:"",confirm_ippis_no:""},validationSchema:Lt,onSubmit:n,children:({errors:r,touched:d,isSubmitting:h})=>e.jsx(ie,{children:e.jsxs(se,{className:"space-y-4",children:[e.jsx(R,{label:"* New IPPIS No.",invalid:!!(r.ippis_no&&d.ippis_no),errorMessage:r.ippis_no,children:e.jsx(T,{name:"ippis_no",type:"text",placeholder:"Enter new IPPIS No.",component:W})}),e.jsx(R,{label:"* Confirm IPPIS No.",invalid:!!(r.confirm_ippis_no&&d.confirm_ippis_no),errorMessage:r.confirm_ippis_no,children:e.jsx(T,{name:"confirm_ippis_no",type:"text",placeholder:"Re-enter new IPPIS No.",component:W})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(I,{variant:"solid",type:"submit",loading:h,children:"Submit"}),e.jsx(I,{variant:"twoTone",onClick:i,children:"Cancel"})]})]})})})]})})},{Tr:Ve,Th:zt,Td:qt,THead:Gt,TBody:$t}=Te,Ae=[{value:10,label:"10 / page"},{value:20,label:"20 / page"},{value:30,label:"30 / page"},{value:40,label:"40 / page"},{value:50,label:"50 / page"}],Wt=({userData:s,filter:i})=>{const{editStaffActive:t}=A(),[a,m]=f.useState([]),[n,r]=f.useState(0),[d,h]=f.useState(!1),[b,l]=f.useState(""),[o,c]=f.useState(!1),[p,v]=f.useState(!1),{Navigate:u}=Se(),{canAccess:g}=$e(),[w,S]=f.useState(!1),[y,V]=f.useState(!1),[N,E]=f.useState(""),[M,H]=f.useState("");f.useEffect(()=>{g(ns)?c(!0):c(!1),g(Oe)?v(!0):v(!1)},[]);const z=()=>{if(i=="")m(s);else{let x=0;i==="active"?x=1:x=0;const j=s.filter($=>$.is_active==x);m(j)}d?h(!1):F.setPageIndex(0)};f.useEffect(()=>{m(s),z()},[s]),f.useEffect(()=>{const x=setTimeout(()=>{const j=F.getState().pagination.pageIndex;F.getRowModel().rows.length===0&&j>0&&F.setPageIndex(j-1)},100);return()=>clearTimeout(x)},[a]),f.useEffect(()=>{r(a.length)},[a]),f.useEffect(()=>{z()},[i]);const O=f.useMemo(()=>[{header:"staff id",accessorKey:"staff_id"},{header:"ippis no",accessorKey:"ippis_no"},{header:"name",accessorKey:"name",cell:x=>{const j=x.row.original;return e.jsxs("div",{className:"flex items-center",children:[j.img!==""?e.jsx(B,{className:"mr-4",src:j.img}):e.jsx(B,{className:"mr-4",icon:e.jsx(Re,{})}),e.jsx(pe,{title:j.name,children:e.jsx("span",{className:"w-full truncate",children:j.name})})]})}},{header:"email",accessorKey:"email"},{header:"active",accessorKey:"is_active",cell:x=>{const j=x.row.original;return e.jsx(rs,{onChange:()=>he(j.staff_id),checked:j.is_active===1,isLoading:d})}},{header:"type",accessorKey:"type"},{header:"grade level",accessorKey:"grade_level"},{header:"action",accessorKey:"",cell:x=>{const j=x.row.original;return e.jsxs("div",{className:"flex  items-center",children:[p&&j.is_active===1&&e.jsx(I,{shape:"circle",size:"xs",className:"mr-2 ",variant:"solid",color:"emerald-500",onClick:()=>xe(j.staff_id),children:"Edit"}),o&&e.jsx(I,{shape:"circle",size:"xs",className:"mr-2",variant:"solid",color:"emerald-500",onClick:()=>C(j.staff_id),children:"View"}),o&&j.type!=="admin"&&j.type!=="hr"&&e.jsx(I,{shape:"circle",size:"xs",className:"mr-2 ",variant:"solid",color:"emerald-500",onClick:()=>q(j.staff_id),children:e.jsx(Bt,{})}),p&&j.is_active===1&&e.jsx(I,{shape:"circle",size:"xs",className:"mr-2 ",variant:"solid",color:"emerald-500",onClick:()=>L(j.staff_id),children:e.jsx(Mt,{})})]})}}],[p,o]),F=Ns({data:a,columns:O,getCoreRowModel:Es(),getFilteredRowModel:_s(),getPaginationRowModel:Cs(),autoResetPageIndex:!1}),he=async x=>{if(l(x),p){h(!0);const j=await t(x);(j==null?void 0:j.status)==="success"&&m($=>$.map(re=>re.staff_id===x?{...re,is_active:re.is_active===1?0:1}:re)),_((j==null?void 0:j.status)||D,(j==null?void 0:j.message)||U)}else _("danger","You have not access to do this");l("")},xe=x=>{u(Ge,x)},C=x=>{u(ks,x)},q=x=>{E(x),S(!0)},L=x=>{H(x),V(!0)},G=x=>{m(j=>j.map($=>$.staff_id===M?{...$,ippis_no:x}:$))},le=x=>{F.setPageIndex(x-1)},ne=(x=0)=>{F.setPageSize(Number(x))};return a.length===0?e.jsx(zs,{}):e.jsxs("div",{children:[e.jsxs(Te,{className:"cursor-default",children:[e.jsx(Gt,{children:F.getHeaderGroups().map(x=>e.jsx(Ve,{children:x.headers.map(j=>e.jsx(zt,{colSpan:j.colSpan,children:Ue(j.column.columnDef.header,j.getContext())},j.id))},x.id))}),e.jsx($t,{children:F.getRowModel().rows.map(x=>e.jsx(Ve,{className:`p-0 ${b===x.original.staff_id?"opacity-50 pointer-events-none":""}`,children:x.getVisibleCells().map(j=>e.jsx(qt,{className:"p-0 m-0",children:Ue(j.column.columnDef.cell,j.getContext())},j.id))},x.id))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(os,{pageSize:F.getState().pagination.pageSize,currentPage:F.getState().pagination.pageIndex+1,total:n,onChange:le}),e.jsx("div",{style:{minWidth:130},children:e.jsx(me,{size:"sm",isSearchable:!1,value:Ae.filter(x=>x.value===F.getState().pagination.pageSize),options:Ae,onChange:x=>ne(x==null?void 0:x.value)})})]}),e.jsx(Tt,{visible:w,onClose:()=>S(!1),staffId:N}),e.jsx(Ht,{visible:y,onClose:()=>V(!1),staffId:M,onSuccess:G})]})},Xt=({search:s,onInputChange:i})=>{const t=a=>{i(a.target.value)};return e.jsx(W,{className:"max-w-md md:w-52 mb-4",size:"sm",placeholder:"Search",prefix:e.jsx(cs,{className:"text-lg"}),value:s,onChange:a=>t(a)})},{Control:Kt}=ds,Be=[{value:"",label:"All",color:"bg-gray-500"},{value:"active",label:"Active",color:"bg-emerald-500"},{value:"blocked",label:"Blocked",color:"bg-red-500"}],Zt=({innerProps:s,label:i,data:t,isSelected:a})=>e.jsxs("div",{className:`flex items-center justify-between p-2 cursor-pointer ${a?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{innerClass:t.color}),e.jsx("span",{children:i})]}),a&&e.jsx(ms,{className:"text-emerald-500 text-xl"})]}),Jt=({children:s,...i})=>{const t=i.getValue()[0];return e.jsxs(Kt,{...i,children:[t&&e.jsx(Le,{className:"ltr:ml-4 rtl:mr-4",innerClass:t.color}),s]})},Yt=({filter:s,onFilterChange:i})=>{const[t,a]=f.useState("");f.useEffect(()=>{a(s)},[s]);const m=n=>{i((n==null?void 0:n.value)||"")};return e.jsx(me,{options:Be,size:"sm",className:"mb-4 min-w-[130px]",components:{Option:Zt,Control:Jt},value:Be.filter(n=>n.value===t),onChange:m})};function Qt(s){return J({attr:{version:"1",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"polygon",attr:{fill:"#90CAF9",points:"40,45 8,45 8,3 30,3 40,13"},child:[]},{tag:"polygon",attr:{fill:"#E1F5FE",points:"38.5,14 29,14 29,4.5"},child:[]},{tag:"polygon",attr:{fill:"#1565C0",points:"21,23 14,33 28,33"},child:[]},{tag:"polygon",attr:{fill:"#1976D2",points:"28,26.4 23,33 33,33"},child:[]},{tag:"circle",attr:{fill:"#1976D2",cx:"31.5",cy:"24.5",r:"1.5"},child:[]}]})(s)}const ea=({buttonShow:s=!1,buttonText:i="",onDialogClose:t})=>{const[a,m]=f.useState(null),{addBulkStaff:n}=A(),r=$s,d=l=>{if(l.length>0){const o=l[0];m(o)}},h=l=>{let o=!0;const c=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"];if(l)for(const p of l)c.includes(p.type)||(o="Please upload a .xlxs");return o},b=async()=>{const l={file:a};if(!l.file){_("danger","Please add file");return}const o=await n(l);_((o==null?void 0:o.status)||D,(o==null?void 0:o.message)||U),(o==null?void 0:o.status)==="success"&&(t==null||t())};return e.jsxs("div",{className:"h-full",children:[e.jsx(we,{draggable:!0,uploadLimit:r,beforeUpload:h,onChange:d,children:e.jsxs("div",{className:"my-16 text-center",children:[e.jsx("div",{className:"text-6xl mb-4 flex justify-center",children:e.jsx(Qt,{})}),e.jsxs("p",{className:"font-semibold",children:[e.jsxs("span",{className:"text-gray-800 dark:text-white",children:["Drop your file here, or"," "]}),e.jsx("span",{className:"text-blue-500",children:"browse"})]}),e.jsx("p",{className:"mt-1 opacity-60 dark:text-white",children:"Support: .xlxs"})]})}),s&&e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(I,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:t,children:ye}),e.jsx(I,{variant:"solid",onClick:b,children:i})]})]})},sa=({buttonShow:s=!1,buttonText:i="",onDialogClose:t})=>{const a=P(o=>o.staffEvidenceOption),{deleteStaffEvidanceById:m}=A(),[n,r]=f.useState([]),[d,h]=f.useState(!1),b=(o,c)=>{r(o)},l=async()=>{h(!0);const o=n.map(v=>v.staff_id);if(o.length===0){_("warning","Please select atleast 1 user who have evidance"),h(!1);return}const p=await m({staff_ids:o});(p==null?void 0:p.status)==="success"&&(t==null||t()),_((p==null?void 0:p.status)||D,(p==null?void 0:p.message)||U),h(!1)};return e.jsxs("div",{children:[e.jsx(me,{isMulti:!0,placeholder:"Please Select",options:a,onChange:b}),s&&e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(I,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:t,children:ye}),e.jsx(I,{variant:"solid",onClick:l,loading:d,children:i})]})]})},ta=fe().shape({selectedStaff:K().required("Select staff Required")}),aa=({search:s,onSearch:i,filter:t,onFilter:a})=>{Y(),P(C=>C.userDetails);const m=P(C=>C.freeStaff.freeStaffOption),[n,r]=f.useState(!1),[d,h]=f.useState(!1),[b,l]=f.useState(0),[o,c]=f.useState(!1),[p,v]=f.useState(!1),{Navigate:u}=Se(),{canAccess:g}=$e(),{getFreeStaff:w,getStaffDowloadlist:S}=A();f.useEffect(()=>{g(Oe)?r(!0):r(!1)},[]);const y=()=>{M(),l(0)},V=()=>{c(!0)},N=()=>{v(!0)},E=async()=>{try{const C=await S(),q=C==null?void 0:C.data;if(!q)throw new Error("blob is not converted");const L=window.URL.createObjectURL(q),G=document.createElement("a");G.href=L,G.download="user_list.xlsx",document.body.appendChild(G),G.click(),document.body.removeChild(G),window.URL.revokeObjectURL(L)}catch(C){console.error("Download failed:",C)}},M=()=>{h(!0)},H=()=>{h(!1)},z=()=>{c(!1)},O=()=>{v(!1)},F=()=>{H(),u(As)},he=async()=>{const C=await w();(C==null?void 0:C.status)!=="success"&&_((C==null?void 0:C.status)||D,(C==null?void 0:C.message)||U),l(1)},xe=()=>{l(b-1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"md:flex items-center justify-between",children:[e.jsxs("div",{className:"md:flex items-center gap-4",children:[e.jsx(Xt,{search:s,onInputChange:i}),e.jsx(Yt,{filter:t,onFilterChange:a})]}),e.jsx("div",{className:"ms-4 mb-4",children:n&&e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm",variant:"solid",icon:e.jsx(qs,{}),onClick:E,className:"me-4 mb-4 lg:mb-0",children:"User List"}),g(fs)&&e.jsx(e.Fragment,{children:e.jsx(I,{size:"sm",variant:"solid",icon:e.jsx(Gs,{}),onClick:N,className:"me-4 mb-4 lg:mb-0",children:"Evidance Delete"})}),e.jsx(I,{size:"sm",variant:"solid",icon:e.jsx(Fe,{}),onClick:V,className:"me-4",children:"Upload bulk user"}),e.jsx(I,{size:"sm",variant:"solid",icon:e.jsx(Fe,{}),onClick:y,children:"Add user"})]})})]}),e.jsxs(Q,{isOpen:d,onClose:H,onRequestClose:H,children:[b===0&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"Confirmation"}),e.jsxs("div",{className:"text-center",children:[e.jsx(I,{className:"ltr:mr-2 rtl:ml-2 mb-4",variant:"solid",onClick:F,children:"Add Custom User"}),e.jsx(I,{className:"ltr:mr-2 rtl:ml-2",variant:"solid",onClick:he,children:"Get From Centeralized System"})]})]}),b===1&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"Select user data to fetch"}),e.jsx(ae,{initialValues:{selectedStaff:""},validationSchema:ta,onSubmit:(C,{resetForm:q,setSubmitting:L})=>{u(Vs,C.selectedStaff),setTimeout(()=>{L(!1),q()},400)},children:({values:C,touched:q,errors:L,resetForm:G})=>e.jsx(ie,{children:e.jsxs(se,{children:[e.jsx(R,{asterisk:!0,label:"Select",invalid:L.selectedStaff&&q.selectedStaff,errorMessage:L.selectedStaff,children:e.jsx(T,{name:"selectedStaff",children:({field:le,form:ne})=>e.jsx(me,{field:le,form:ne,options:m,value:m.filter(x=>x.staff_id===C.selectedStaff),onChange:x=>ne.setFieldValue(le.name,x==null?void 0:x.staff_id)})})}),e.jsxs(R,{children:[e.jsx(I,{type:"reset",className:"ltr:mr-2 rtl:ml-2",onClick:xe,children:"Back"}),e.jsx(I,{variant:"solid",type:"submit",children:"Fetch Data"})]})]})})})]})]}),e.jsx(Q,{isOpen:o,onClose:z,onRequestClose:z,children:e.jsx(ea,{buttonShow:!0,buttonText:Ws,onDialogClose:z})}),e.jsx(Q,{isOpen:p,onClose:O,onRequestClose:O,children:e.jsx(sa,{buttonShow:!0,buttonText:Xs,onDialogClose:O})})]})},ia=({id:s})=>{const{Navigate:i}=Se(),t=()=>{i(Ge,String(s))};return e.jsx(e.Fragment,{children:e.jsx(I,{block:!0,icon:e.jsx(us,{}),variant:"solid",onClick:t,children:Ks})})},la=({data:s={},showButton:i=!0})=>{const t=Y(),a=P(n=>n.userDetails),m=()=>{const n={...a,modal:!0,category:We,id:String(s.staff_id),height:250,width:500};t(be(n))};return e.jsx(ce,{children:e.jsxs("div",{className:"flex flex-col xl:justify-between h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[s.img===""?e.jsx(B,{size:90,shape:"circle",icon:e.jsx(Re,{}),onClick:m,className:"cursor-pointer"}):e.jsx(B,{size:90,shape:"circle",src:s.img,onClick:m,className:"cursor-pointer"}),e.jsxs("h4",{className:"font-bold",children:[s.F_name," ",s.M_name," ",s.L_name]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(k,{title:"Email:",value:s.email,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Phone:",value:s.phone,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Gender:",value:s.gender,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Role:",value:s.role,customClassName:"flex gap-1 w-full truncate"})]}),i&&e.jsx("div",{className:"mt-4 flex flex-col xl:flex-row gap-2",children:e.jsx(ia,{id:s.staff_id})})]})})};function na(s){return J({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M579.8 267.7c56.5-56.5 56.5-148 0-204.5c-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6c31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0c-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0L579.8 267.7zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5c50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5L217.7 177.2c31.5-31.5 82.5-31.5 114 0c27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"},child:[]}]})(s)}function ra(s){return J({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M64 464l48 0 0 48-48 0c-35.3 0-64-28.7-64-64L0 64C0 28.7 28.7 0 64 0L229.5 0c17 0 33.3 6.7 45.3 18.7l90.5 90.5c12 12 18.7 28.3 18.7 45.3L384 304l-48 0 0-144-80 0c-17.7 0-32-14.3-32-32l0-80L64 48c-8.8 0-16 7.2-16 16l0 384c0 8.8 7.2 16 16 16zM176 352l32 0c30.9 0 56 25.1 56 56s-25.1 56-56 56l-16 0 0 32c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-48 0-80c0-8.8 7.2-16 16-16zm32 80c13.3 0 24-10.7 24-24s-10.7-24-24-24l-16 0 0 48 16 0zm96-80l32 0c26.5 0 48 21.5 48 48l0 64c0 26.5-21.5 48-48 48l-32 0c-8.8 0-16-7.2-16-16l0-128c0-8.8 7.2-16 16-16zm32 128c8.8 0 16-7.2 16-16l0-64c0-8.8-7.2-16-16-16l-16 0 0 96 16 0zm80-112c0-8.8 7.2-16 16-16l48 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 32 32 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-32 0 0 48c0 8.8-7.2 16-16 16s-16-7.2-16-16l0-64 0-64z"},child:[]}]})(s)}function oa(s){return J({attr:{t:"1569683621237",viewBox:"0 0 1024 1024",version:"1.1"},child:[{tag:"path",attr:{d:"M944 299H692c-4.4 0-8 3.6-8 8v406c0 4.4 3.6 8 8 8h59.2c4.4 0 8-3.6 8-8V549.9h168.2c4.4 0 8-3.6 8-8V495c0-4.4-3.6-8-8-8H759.2V364.2H944c4.4 0 8-3.6 8-8V307c0-4.4-3.6-8-8-8zM588 300h-56c-4.4 0-8 3.6-8 8v406c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V308c0-4.4-3.6-8-8-8zM452 500.9H290.5c-4.4 0-8 3.6-8 8v43.7c0 4.4 3.6 8 8 8h94.9l-0.3 8.9c-1.2 58.8-45.6 98.5-110.9 98.5-76.2 0-123.9-59.7-123.9-156.7 0-95.8 46.8-155.2 121.5-155.2 54.8 0 93.1 26.9 108.5 75.4h76.2c-13.6-87.2-86-143.4-184.7-143.4C150 288 72 375.2 72 511.9 72 650.2 149.1 736 273 736c114.1 0 187-70.7 187-181.6v-45.5c0-4.4-3.6-8-8-8z"},child:[]}]})(s)}const Ze=({type:s="",url:i="",className:t="",clickAble:a=!1,evidanceID:m=""})=>{const{getStaffEvidanceFileByIdTemporary:n}=A(),r=async()=>{if(a){const h=await n(m);if(h!=null&&h.data){const b=new Blob([h.data],{type:"application/pdf"}),l=URL.createObjectURL(b);window.open(l)}}},d=()=>s.toUpperCase()==="PDF"?e.jsx(B,{className:`mr-4 ${a&&"cursor-pointer"}`,icon:e.jsx(ra,{}),onClick:r}):s.toUpperCase()==="JPEG"||s.toUpperCase()==="PNG"?e.jsx(B,{className:`mr-4 ${t}`,src:i}):s.toUpperCase()==="DOC"||s.toUpperCase()==="DOCX"?e.jsx(B,{className:"mr-4",icon:e.jsx(ke,{})}):s.toUpperCase()==="XLS"||s.toUpperCase()==="XLSX"?e.jsx(B,{className:"mr-4",icon:e.jsx(Ut,{})}):s.toUpperCase()==="GIF"?e.jsx(B,{className:"mr-4",icon:e.jsx(oa,{})}):e.jsx(B,{className:"mr-4",icon:e.jsx(ke,{})});return e.jsx("div",{children:d()})},Je=({isOpen:s=!1,onDialogClose:i,onButtonFunction:t,isLoading:a=!1})=>e.jsxs(Q,{isOpen:s,bodyOpenClassName:"overflow-hidden",onClose:i,onRequestClose:i,children:[e.jsx(oe,{title:Zs}),e.jsx("p",{className:"text-lg",children:"Are you sure want to delete the Evidance?"}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(I,{variant:"solid",size:"sm",color:"red-600",icon:e.jsx(hs,{}),onClick:t,loading:a,children:"Delete"})})]}),Ye=({showNumber:s=0,textWidthClassName:i="w-full"})=>{const t=Y(),a=P(u=>u.currentStaff)[0],m=P(u=>u.currentStaffEvidance),n=P(u=>u.userEvidanceDrawer),[r,d]=f.useState(!1),{deleteStaffEvidanceByEvidanceId:h}=A(),b=f.useRef(!1),l=f.useRef(-1),o=async()=>{b.current=!0;const u={staff_id:a.staff_id,evidanceId:String(m[l.current].id)},g=await h(u);_((g==null?void 0:g.status)||D,(g==null?void 0:g.message)||U),b.current=!1,p()},c=u=>{d(!0),l.current=u},p=()=>{d(!1)},v=u=>{const g={...n,isOpen:!0,staffId:a.staff_id,evidanceId:String(m[u].id)};t(te(g))};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600",children:m.map((u,g)=>e.jsxs("div",{className:He("flex flex-col lg:flex-row lg:items-center justify-between gap-3 p-4",s!==0&&g>s&&"hidden",!Xe(m,g)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:`flex items-center gap-3 ${i} truncate`,children:[e.jsx(Ze,{type:u.file_type,url:u.file_path}),e.jsx("div",{className:"",children:e.jsx("div",{className:"text-gray-900 dark:text-gray-100 font-semibold",children:u.name})})]}),e.jsxs("div",{className:"flex",children:[e.jsx(I,{className:"mr-2 rtl:ml-2",variant:"plain",size:"sm",onClick:()=>c(g),children:"Delete"}),e.jsx(I,{icon:e.jsx(Dt,{}),size:"sm",onClick:()=>v(g),children:"View"})]})]},g))}),e.jsx(Je,{isOpen:r,onDialogClose:p,onButtonFunction:o,isLoading:b.current})]})},ca=({data:s})=>{const{deleteStaffEvidanceByEvidanceId:i}=A(),t=async()=>{const n={staff_id:(s==null?void 0:s.staff_id)||"",evidanceId:String(s==null?void 0:s.id)},r=await i(n);_((r==null?void 0:r.status)||D,(r==null?void 0:r.message)||U)},a=n=>{const r=document.createElement("textarea");r.value=n,r.style.position="fixed",document.body.appendChild(r),r.focus(),r.select();try{if(document.execCommand("copy"))_("success","Copy to clipboard");else throw new Error("Fallback copy failed.")}catch(d){console.error("Fallback copy error:",d),_("danger","Failed to copy. Please copy manually.")}document.body.removeChild(r)},m=n=>{var r;(r=navigator==null?void 0:navigator.clipboard)!=null&&r.writeText?navigator.clipboard.writeText(n).then(()=>{_("success","Copy to clipboard")}).catch(d=>{console.error("Clipboard API error:",d),a(n)}):a(n)};return e.jsxs("div",{className:"grid gap-4",children:[e.jsx(k,{title:"name",value:s==null?void 0:s.name}),e.jsx(k,{title:"description",value:s==null?void 0:s.description,convertValue:!0}),e.jsx(Ze,{type:s==null?void 0:s.file_type,url:s==null?void 0:s.file_path,className:"w-full h-full",clickAble:!0,evidanceID:s==null?void 0:s.evidence_id}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(I,{className:"mr-2 rtl:ml-2",variant:"solid",size:"sm",onClick:t,children:"Delete"}),e.jsx(I,{className:"mr-2 rtl:ml-2",variant:"plain",size:"sm",icon:e.jsx(na,{}),onClick:()=>m((s==null?void 0:s.file_path)||""),children:"copy"})]})]})};function Qe(s){return J({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"48",d:"M328 112 184 256l144 144"},child:[]}]})(s)}const da=s=>{const i=Y(),t=P(d=>d.userEvidanceDrawer),a=P(d=>d.currentStaffEvidance),m=()=>a.find(d=>String(d.id)===String(t.evidanceId)),n=()=>{const d={...t,evidanceId:"all"};i(te(d))},r=()=>{const d={...t,isOpen:!1,staffId:"",evidanceId:""};i(te(d))};return e.jsxs(de,{title:e.jsxs("div",{className:"flex gap-2 items-center",children:[t.evidanceId!=="all"&&e.jsx(I,{icon:e.jsx(Qe,{}),onClick:n}),e.jsx("h5",{children:"Evidance details"})]}),isOpen:t.isOpen,onClose:r,onRequestClose:r,children:[t.evidanceId==="all"&&e.jsx(Ye,{}),t.evidanceId!=="all"&&e.jsx(ca,{data:m()})]})},ma=({showViewAllButton:s=!0})=>{const i=Y(),t=P(v=>v.currentStaff)[0],a=P(v=>v.currentStaffEvidance),m=P(v=>v.userEvidanceDrawer),[n,r]=f.useState(!1),{deleteStaffEvidanceById:d}=A(),h=f.useRef(!1),b=()=>{if(m.isOpen){const u={...m,isOpen:!1,staffId:"",evidanceId:""};i(te(u))}const v={modal:!0,id:t.staff_id,category:ee,type:ee,action:je,height:st,width:et};i(be(v))},l=async()=>{h.current=!0;const v={staff_ids:[t.staff_id],currentStaffId:t.staff_id},u=await d(v);_((u==null?void 0:u.status)||D,(u==null?void 0:u.message)||U),h.current=!1,c()},o=()=>{r(!0)},c=()=>{r(!1)},p=()=>{const v={...m,isOpen:!0,staffId:t.staff_id,evidanceId:"all"};i(te(v))};return e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx(ue,{header:ee,subHeader:Qs,addButton:Ys,addButtonFunction:b,deleteButton:!Z.isEmpty(a)&&Js,deleteButtonFunction:o}),Z.isEmpty(a)?e.jsx("p",{children:"No Evidance found..."}):e.jsxs("div",{children:[e.jsx(Ye,{showNumber:De,textWidthClassName:"w-40"}),a.length>De&&e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(I,{variant:"solid",size:"sm",onClick:p,children:"...View All"})})]})]}),e.jsx(da,{}),e.jsx(Je,{isOpen:n,onDialogClose:c,onButtonFunction:l,isLoading:h.current})]})},fa=({data:s,customClassName:i})=>e.jsxs("div",{className:`${i}`,children:[e.jsx(ue,{header:rt,subHeader:nt,editButton:lt,editButtonText:it,addButton:at,addButtonText:tt}),Z.isEmpty(s)?e.jsx("div",{className:"mb-8",children:"No Data Found ..."}):e.jsx(ce,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-7 gap-x-4",children:e.jsx(k,{title:"IPPS NO.",value:s.ippis_no,customClassName:"flex gap-1"})})})]}),ua=({data:s,customClassName:i})=>Z.isEmpty(s)?e.jsx("div",{className:"mb-8",children:"No Data Found ..."}):e.jsxs("div",{className:i,children:[e.jsx(ue,{header:ut,subHeader:ft,editButton:mt,editButtonText:dt,addButton:ct,addButtonText:ot}),e.jsx(ce,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-y-7 gap-x-4",children:[e.jsx(k,{title:"Recovery Email:",value:s.recovery_email,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Cadre:",value:s.cadre,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Job Title:",value:s.job_title,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Designation:",value:s.designation,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Date of MDA Posting:",value:s.date_of_MDA_posting,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Date of Current Posting:",value:s.date_of_current_posting,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Date of Last Promotion Posting:",value:s.date_of_last_promotion,customClassName:"flex gap-1 w-full truncate"}),e.jsx(k,{title:"Grade Lavel:",value:s.grade_level,customClassName:"flex gap-1 w-full truncate"})]})})]}),ha=({id:s="",isDrawerOpen:i=!1,formId:t="all",onDrawerClose:a})=>{const m=P(r=>r.currentStaffForm),n=()=>{t="all"};return e.jsx(de,{title:e.jsxs("div",{className:"flex gap-2 items-center",children:[t!=="all"&&e.jsx(I,{icon:e.jsx(Qe,{}),onClick:n}),e.jsx("h5",{children:ht})]}),isOpen:i,onClose:a,onRequestClose:a,children:e.jsx(es,{headerShow:!1,id:s,data:m,showNumber:0,looksClassName:"",onDrawerClassName:"mb-4",onDrawerFormShowClassName:"grid grid-cols-7 gap-2"})})},es=({headerShow:s=!0,id:i="",data:t=[],showNumber:a=3,customClassName:m,looksClassName:n="flex flex-col lg:flex-row lg:items-center justify-between gap-3",onDrawerClassName:r,onDrawerFormShowClassName:d="flex items-center w-full overflow-x-scroll overflow-y-hidden gap-3"})=>{const[h,b]=f.useState(!1),l=()=>{b(!0)},o=()=>{b(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:m,children:[s&&e.jsx(ue,{header:jt,subHeader:pt,editButton:a!==0&&t.length>a&&gt,editButtonText:xt,editButtonFunction:l}),Z.isEmpty(t)?e.jsx("p",{children:"No Form found..."}):e.jsx("div",{className:"rounded-lg border border-gray-200 dark:border-gray-600",children:t.map((c,p)=>e.jsxs("div",{className:He(`${n} p-4`,a!==0&&p>a&&"hidden",!Xe(t,p)&&"border-b border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:`flex items-center gap-3 w-full truncate ${r}`,children:[e.jsx(pe,{title:c.department_name,children:e.jsx("span",{className:"w-20 truncate cursor-default",children:c.department_name})}),">",e.jsx(pe,{title:c.team_name,children:e.jsx("span",{className:"w-20 truncate cursor-default",children:c.team_name})}),">",e.jsx("span",{children:e.jsx(xs,{className:"text-white bg-green-600 border-0",children:c.role})})]}),e.jsxs("div",{className:d,children:[e.jsx(X,{type:Bs,redirect:gs,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Ms,redirect:ps,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Os,redirect:js,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Rs,redirect:vs,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Ts,redirect:ws,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Ls,redirect:bs,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0}),e.jsx(X,{type:Hs,redirect:Ss,staffId:i,departmentId:String(c.department_id),teamId:String(c.team_id),clickAble:!0})]})]},p))})]}),a!==0&&h&&e.jsx(ha,{id:i,isDrawerOpen:h,onDrawerClose:o})]})},xa=({imageDetails:s,onValueChange:i,submitButtonShow:t=!1,onSubmit:a})=>{const[m,n]=f.useState(null),[r,d]=f.useState(null);f.useEffect(()=>{if(s!=null&&s.imageFile){const l=s.imageFile,o=URL.createObjectURL(l);return n(o),()=>{URL.revokeObjectURL(o)}}else s!=null&&s.imageUrl?n(s.imageUrl):(n(null),d(null))},[s]);const h=l=>{if(l.length>0){const o=l[0],c=URL.createObjectURL(o);d(o),n(c),i==null||i({imageUrl:c,imageFile:o})}},b=l=>{let o=!0;const c=["image/jpeg","image/png"];if(l)for(const p of l)c.includes(p.type)||(o="Please upload a .jpeg or .png file!");return o};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(we,{className:"cursor-pointer",showList:!1,uploadLimit:1,beforeUpload:b,onChange:h,children:e.jsx(B,{size:80,src:m,icon:e.jsx(Is,{})})})}),e.jsx("div",{className:"text-right mt-6",children:t&&e.jsx(I,{variant:"solid",onClick:()=>a==null?void 0:a({imageUrl:m,imageFile:r}),children:vt})})]})},ga=({formValue:s=Ke,type:i,onValueChange:t,handleSubmit:a,submitButton:m=!1,submitButtonText:n="",isSubmit:r=!1,backButton:d=!1,backButtonText:h="",cancelButton:b=!1,cancelButtonText:l="",onCancel:o})=>{const c=wt,p=(u,g)=>{let w=!0;const S=St,y=It;if(g.length>=c)return`You can only upload ${c} file(s)`;if(u)for(const V of u)S.includes(V.type)||(w=yt),V.size>=y&&(w=Nt);return w},v=e.jsx("p",{className:"mt-2",children:bt});return e.jsx(ae,{enableReinitialize:!0,initialValues:s,validationSchema:Vt,onSubmit:(u,{setSubmitting:g})=>{a==null||a(u),g(!1)},children:({values:u,errors:g,touched:w,isSubmitting:S})=>e.jsxs(ie,{children:[e.jsxs(se,{children:[e.jsx("div",{className:"",children:e.jsx(R,{label:"Evidance Name",invalid:!!(w.name&&g.name),errorMessage:g.name,children:e.jsx(T,{name:"name",type:"text",placeholder:"Evidance Name",as:W,value:u.name})})}),e.jsx("div",{className:"",children:e.jsx(R,{label:"Evidance description",labelClass:"!justify-start",invalid:g.description&&w.description,errorMessage:g.description,children:e.jsx(T,{name:"description",placeholder:"Evidance Description",children:({field:y,form:V})=>e.jsx(Fs,{value:y.value,onChange:N=>V.setFieldValue(y.name,N)})})})}),e.jsx("div",{className:"",children:e.jsx(R,{label:"Evidance File",labelClass:"!justify-start",invalid:g.file_path&&w.file_path,errorMessage:g.file_path,children:e.jsx(T,{name:"file_path",children:({field:y,form:V})=>e.jsx(we,{onChange:N=>V.setFieldValue(y.name,N[0]),beforeUpload:p,onFileRemove:()=>V.setFieldValue(y.name,null),uploadLimit:c,tip:v})})})})]}),e.jsxs("div",{className:"text-right mt-6",children:[b&&e.jsx(I,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:o,children:l}),m&&e.jsx(I,{variant:"solid",loading:r||S,children:n})]})]})})},pa=s=>{const i=Y(),t=P(w=>w.userDetails),a=P(w=>w.currentStaff),{addStaffEvidanceById:m,uploadStaffImage:n}=A(),[r,d]=f.useState({imageUrl:null,imageFile:null}),[h,b]=f.useState(),[l,o]=f.useState(Ke),c=f.useRef(!1);f.useEffect(()=>{t.type===ve&&a.length>0&&b({role:a[0].role,access:a[0].access,permission:a[0].permission,department:a[0].department}),t.type===ve&&t.category===ee&&t.action===Ct&&console.log("edit"),a.length>0&&d({...r,imageUrl:a[0].img})},[t.type,t.category,t.action,a]);const p=()=>{const w={...t,modal:!1,category:"",action:"",height:"",width:""};i(be(w))},v=async w=>{if(w.imageFile===null&&w.imageUrl===null)_("warning","Please upload a photo");else if(w.imageFile===null&&w.imageUrl!==null)_("warning","You are stay in your previous profile image"),p();else if(w.imageFile!==null){const S={staffId:a[0].staff_id,profile_image:w.imageFile},y=await n(S);_((y==null?void 0:y.status)||D,(y==null?void 0:y.message)||U),p()}else _(D,U)},u=w=>{console.log(w)},g=async w=>{c.current=!0;const S={staff_id:t.id,name:w.name,description:w.description,file_path:w.file_path},y=await m(S);_((y==null?void 0:y.status)||D,(y==null?void 0:y.message)||U),c.current=!1,(y==null?void 0:y.status)==="success"&&p()};return e.jsxs(Q,{isOpen:t.modal,bodyOpenClassName:"overflow-hidden",width:t.width,height:t.height,onClose:p,onRequestClose:p,children:[e.jsx(oe,{title:t.category}),e.jsxs("div",{children:[t.category===We&&e.jsx(e.Fragment,{children:e.jsx(xa,{imageDetails:r,submitButtonShow:!0,onSubmit:v})}),t.category===_t&&e.jsx(e.Fragment,{children:e.jsx(kt,{headerTag:"h5",formValue:h,buttonNameFirst:Et,onFormSubmit:u})}),e.jsx("div",{className:"max-h-96 overflow-y-scroll",children:t.category===ee&&t.action===je&&e.jsx(e.Fragment,{children:e.jsx(ga,{formValue:l,cancelButton:!0,cancelButtonText:ye,submitButton:!0,submitButtonText:je,handleSubmit:g,isSubmit:c.current})})})]})]})},ja=s=>{const{id:i}=ze(),t=P(b=>b.currentStaff)[0],a=P(b=>b.currentStaffForm),[m,n]=f.useState(!0),{getStaffById:r,getStaffEvidanceById:d,getStaffFormById:h}=A();return f.useEffect(()=>{(async()=>{if(m){const l=await r(String(i));(l==null?void 0:l.status)!=="success"&&_((l==null?void 0:l.status)||D,(l==null?void 0:l.message)||U);const o=await d(String(i));(o==null?void 0:o.status)!=="success"&&_((o==null?void 0:o.status)||D,(o==null?void 0:o.message)||U);const c=await h(String(i));(c==null?void 0:c.status)!=="success"&&_((c==null?void 0:c.status)||D,(c==null?void 0:c.message)||U)}n(!1)})()},[i]),e.jsxs(Ps,{className:"h-full",children:[e.jsx(Me,{loading:m,children:!Z.isEmpty(t)&&e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4",children:[e.jsxs("div",{children:[e.jsx(la,{data:t}),e.jsx(fa,{data:t,customClassName:"mt-1"}),e.jsx(ma,{})]}),e.jsx("div",{className:"w-full",children:e.jsxs(qe,{children:[e.jsx(Ft,{id:t.staff_id,type:ve,data:t.permission}),e.jsx(ua,{data:t,customClassName:"mt-4"}),e.jsx(es,{id:t.staff_id,data:a,customClassName:"mt-4"})]})})]})}),e.jsx(pa,{}),!m&&Z.isEmpty(t)&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center",children:[e.jsx(Pt,{src:"/img/others/img-2.png",darkModeSrc:"/img/others/img-2-dark.png",alt:"No user found!"}),e.jsx("h3",{className:"mt-8",children:"No user found!"})]})]})},va=s=>e.jsx("div",{className:"flex flex-col gap-4",children:e.jsx("div",{className:"flex flex-auto items-center gap-2",children:e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(Pe,{height:10}),e.jsx(Pe,{height:10,width:"60%"})]})})}),Wa=s=>{const{id:i}=ze(),t=P(N=>N.staff)||[],[a,m]=f.useState(!0),[n,r]=f.useState(""),[d,h]=f.useState(""),[b,l]=f.useState([]),[o,c]=f.useState({value:0,growShrink:0,label:"Total Users"}),[p,v]=f.useState({value:0,growShrink:0,label:"Active Users"}),[u,g]=f.useState({value:0,growShrink:0,label:"Blocked Users"}),{getStaff:w}=A();f.useEffect(()=>{const N=async()=>{const E=await w();(E==null?void 0:E.status)!=="success"&&_((E==null?void 0:E.status)||D,(E==null?void 0:E.message)||U),m(!1)};t.length===0?N():m(!1)},[t]),f.useEffect(()=>{if(n!==""){const O=t.filter(F=>F.name.toLowerCase().includes(n.toLowerCase())||F.email.toLowerCase().includes(n.toLowerCase())||F.staff_id.toLowerCase().includes(n.toLowerCase())||F.ippis_no.toLowerCase().includes(n.toLowerCase()));l(O)}else l(t);const N=t.length,E=t.filter(O=>O.is_active===1).length,M=E/N*100,H=t.filter(O=>O.is_active===0).length,z=H/N*100;c({value:N,growShrink:100,label:"Total Users"}),v({value:E,growShrink:Number(M.toFixed(2)),label:"Active Users"}),g({value:H,growShrink:Number(z.toFixed(2)),label:"Blocked Users"})},[t]);const S=N=>{N.length!==0&&h(""),r(N);const E=t.filter(M=>M.name.toLowerCase().includes(N.toLowerCase())||M.email.toLowerCase().includes(N.toLowerCase())||M.staff_id.toLowerCase().includes(N.toLowerCase())||M.ippis_no.toLowerCase().includes(N.toLowerCase()));l(E)},y=N=>{S(""),h(N)},V=N=>{N===o.label?h(""):N===p.label?h("active"):N===u.label&&h("blocked")};return a?e.jsx(va,{}):e.jsx(e.Fragment,{children:i==="all"?e.jsxs(e.Fragment,{children:[e.jsx(At,{total:o,active:p,blocked:u,onClickedFunction:V}),e.jsxs(qe,{className:"h-full",bodyClass:"h-fulll",children:[e.jsx(aa,{search:n,onSearch:S,filter:d,onFilter:y}),e.jsx(Wt,{userData:b,filter:d})]})]}):e.jsx(ja,{})})};export{Wa as default};
