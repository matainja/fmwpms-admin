import{j as e,bR as F,B as o,cB as K,b0 as H,b1 as j,b2 as x,aa as w,bA as B,u as W,cE as z,r as M,bj as h,bh as u,cF as V,cx as X,cG as G,cH as $}from"./index-DT1ln_eE.js";import{b as I,f as L}from"./index-C3iPqOVG.js";import{u as P}from"./useMPMS-CMUq-J-t.js";import{u as T,D as E}from"./useNavigation-BQ2pplMO.js";import{H as _}from"./Header-CBoPUbhm.js";import{G as J}from"./index-kdwdwyUk.js";import{S as f}from"./StaffInfoFeild-B951btuS.js";import{F as Q,c as U,a as Y,b as g,e as v,j as y}from"./index.esm-aWjOEKw7.js";import{d as Z,a as ee}from"./defaultErrorMessage.constant-Bll1G2ZT.js";import{u as te}from"./useAccessibility-TGX7NoMS.js";import"./index-54o3matW.js";import"./cloneDeep-DJN0yfLA.js";import"./lodash-DX-5BQXz.js";const ie=({title:b,subTitle:n,year:r,id:a})=>{const{Navigate:m}=T(),p=()=>{m(E,String(a),K,n)};return e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsxs("div",{className:"mb-4 lg:mb-0 flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{title:b}),e.jsx("p",{children:n})]}),e.jsx(F,{className:"text-white bg-emerald-600 border-0 rounded",children:r})]}),e.jsxs("div",{className:"md:flex justify-center gap-2",children:[e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(J,{}),onClick:p}),e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(I,{})})]})]})},se=U().shape({obj_title:v().required("Title is required"),obj_weight:y().typeError("Weight must be a number").required("Weight is required"),Initiative:v().required("Initiative is required"),kpi:v().required("KPI is required"),target:y().typeError("Target must be a number").required("Target is required"),Responsible:v().required("Responsible is required")}),ae=({isOpen:b,onClose:n,objective:r,onSave:a})=>{const{EditAssociativeObjectiveMPMS:m}=P();if(!b||!r)return null;const p=async(t,{setSubmitting:c})=>{const N={id:Number(r.id),obj_title:t.obj_title,obj_weight:Number(t.obj_weight),Initiative:t.Initiative,kpi:t.kpi,target:Number(t.target),Responsible:t.Responsible},l=await m(N);w((l==null?void 0:l.status)||ee,(l==null?void 0:l.message)||Z),(l==null?void 0:l.status)==="success"&&(n(),a==null||a()),c(!1)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-full max-w-lg",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"Edit Objective"}),e.jsx(Q,{initialValues:{...r},enableReinitialize:!0,validationSchema:se,onSubmit:p,children:({errors:t,touched:c})=>e.jsx(Y,{children:e.jsxs(H,{className:"space-y-4",children:[e.jsx(j,{label:"Objective Title",invalid:!!(t.obj_title&&c.obj_title),errorMessage:t.obj_title,children:e.jsx(g,{name:"obj_title",component:x,placeholder:"Enter objective title"})}),e.jsx(j,{label:"Objective Weight",invalid:!!(t.obj_weight&&c.obj_weight),errorMessage:t.obj_weight,children:e.jsx(g,{name:"obj_weight",component:x,placeholder:"Enter objective weight"})}),e.jsx(j,{label:"Initiative",invalid:!!(t.Initiative&&c.Initiative),errorMessage:t.Initiative,children:e.jsx(g,{name:"Initiative",component:x,placeholder:"Enter initiative"})}),e.jsx(j,{label:"KPI",invalid:!!(t.kpi&&c.kpi),errorMessage:t.kpi,children:e.jsx(g,{name:"kpi",component:x,placeholder:"Enter KPI"})}),e.jsx(j,{label:"Target",invalid:!!(t.target&&c.target),errorMessage:t.target,children:e.jsx(g,{name:"target",component:x,placeholder:"Enter target"})}),e.jsx(j,{label:"Responsible",invalid:!!(t.Responsible&&c.Responsible),errorMessage:t.Responsible,children:e.jsx(g,{name:"Responsible",component:x,placeholder:"Enter responsible person"})}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx(o,{type:"button",variant:"solid",color:"gray-500",onClick:n,children:"Cancel"}),e.jsx(o,{type:"submit",variant:"solid",color:"green-600",children:"Save"})]})]})})})]})})},ue=b=>{const{type:n,id:r}=B(),a=W(z(n||"",r||"")),{Navigate:m}=T(),{canAccess:p}=te(),{getMPMS:t,deleteDepartmentKraMPMS:c,deleteObjectKraMPMS:N}=P(),[l,S]=M.useState(!1),[k,D]=M.useState(null);M.useEffect(()=>{(async()=>{await t()})()},[]);const O=async()=>{m(E,r,G,n)},R=async()=>{m(E,r,$,n)},A=async i=>{const d={kra_id:String(r),department:String(i)},s=await c(d);w((s==null?void 0:s.status)||"warning",(s==null?void 0:s.message)||"Call developer")},C=i=>{const d=a[0].objs.find(s=>s.id===i);d&&(D(d),S(!0))},q=async i=>{const d={objectiveId:String(i)},s=await N(d);w((s==null?void 0:s.status)||"warning",(s==null?void 0:s.message)||"Call developer")};return a.length===0?e.jsxs("div",{className:"flex flex-col gap-4",style:{maxWidth:300},children:[e.jsxs("div",{className:"flex flex-auto items-center gap-2",children:[e.jsx("div",{children:e.jsx(h,{variant:"circle",height:35,width:35})}),e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[e.jsx(h,{height:10}),e.jsx(h,{height:10,width:"60%"})]})]}),e.jsx(h,{height:150})]}):e.jsxs("div",{children:[e.jsx(ie,{title:a[0].kra_title,subTitle:n||"",year:a[0].year,id:a[0].id}),e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsx(_,{title:"Associate with Department",titleTag:"h5"}),e.jsx(o,{size:"xs",className:"mr-2",variant:"solid",color:"emerald-500",onClick:O,children:"Add Department"})]}),e.jsx("div",{className:"mt-4 grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:a[0].departments.map(i=>e.jsx(u,{children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-black",children:i.department_name}),e.jsx("div",{children:e.jsx(V,{className:"ml-1 rtl:mr-1 cursor-pointer",onClick:()=>A(i.department_id)})})]})},i.id))})]}),e.jsxs(u,{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 gap-3",children:[e.jsx(_,{title:"Associate with Objective",titleTag:"h5"}),e.jsx(o,{size:"xs",className:"mr-2",variant:"solid",color:"emerald-500",onClick:R,children:"Add Objective"})]}),e.jsx("div",{className:"grid gap-4 mt-4",children:a[0].objs.map((i,d)=>e.jsxs(u,{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-black",children:i.obj_title}),e.jsxs("div",{className:"md:flex justify-center gap-2",children:[e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(L,{}),onClick:()=>C(i.id)}),p(X)&&e.jsx(e.Fragment,{children:e.jsx(o,{shape:"circle",variant:"twoTone",color:"green-600",icon:e.jsx(I,{}),onClick:()=>q(i.id)})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3",children:[e.jsx(f,{title:"Weight:",value:String(i.obj_weight),customClassName:"flex gap-2"}),e.jsx(f,{title:"Initiative:",value:String(i.Initiative),customClassName:"flex gap-2"}),e.jsx(f,{title:"Kpi:",value:String(i.kpi),customClassName:"flex gap-2"}),e.jsx(f,{title:"Responsible:",value:i.Responsible,customClassName:"flex gap-2"})]})]},d))})]}),e.jsx(ae,{isOpen:l,onClose:()=>S(!1),objective:k})]})};export{ue as default};
